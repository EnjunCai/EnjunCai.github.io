import{R as fe,I as Ce,$ as so,L as co,H as uo,x as mo}from"./@vavt-12646459.js";import{_ as fo,E as Z,H as qt,s as Gt,k as go,d as ho,h as vo,i as po,a as bt,m as bo,l as Vo,u as yo,r as ko,b as Co,c as z,e as be,f as wo,p as $o,g as To,C as ee,S as No}from"./@codemirror-453f4d42.js";import{a as p}from"./@lezer-9e9c314f.js";import{m as _o}from"./medium-zoom-45da89b9.js";import{a as xo}from"./copy-to-clipboard-ca358197.js";import{M as So}from"./markdown-it-dbab3289.js";import{r as Eo}from"./markdown-it-image-figures-6b4113de.js";import{m as Io}from"./markdown-it-task-lists-1295841e.js";import{m as Lo}from"./markdown-it-xss-e9dc809c.js";import{L as Ho}from"./lru-cache-b2f61452.js";const s="md-editor",Mo="https://at.alicdn.com/t/c/font_2605852_prouiefeic.js",Ao="https://at.alicdn.com/t/c/font_2605852_prouiefeic.css",L="https://cdnjs.cloudflare.com/ajax/libs",Fo=`${L}/highlight.js/11.8.0/highlight.min.js`,Vt={main:`${L}/prettier/2.8.0/standalone.js`,markdown:`${L}/prettier/2.8.0/parser-markdown.js`},yt={css:`${L}/cropperjs/1.5.13/cropper.min.css`,js:`${L}/cropperjs/1.5.13/cropper.min.js`},jo=`${L}/screenfull.js/5.2.0/screenfull.min.js`,Kt=["bold","underline","italic","strikeThrough","-","title","sub","sup","quote","unorderedList","orderedList","task","-","codeRow","code","link","image","table","mermaid","katex","-","revoke","next","save","=","prettier","pageFullscreen","fullscreen","preview","htmlPreview","catalog","github"],Zt=["markdownTotal","=","scrollSwitch"],kt={"zh-CN":{toolbarTips:{bold:"加粗",underline:"下划线",italic:"斜体",strikeThrough:"删除线",title:"标题",sub:"下标",sup:"上标",quote:"引用",unorderedList:"无序列表",orderedList:"有序列表",task:"任务列表",codeRow:"行内代码",code:"块级代码",link:"链接",image:"图片",table:"表格",mermaid:"mermaid图",katex:"katex公式",revoke:"后退",next:"前进",save:"保存",prettier:"美化",pageFullscreen:"浏览器全屏",fullscreen:"屏幕全屏",preview:"预览",htmlPreview:"html代码预览",catalog:"目录",github:"源码地址"},titleItem:{h1:"一级标题",h2:"二级标题",h3:"三级标题",h4:"四级标题",h5:"五级标题",h6:"六级标题"},imgTitleItem:{link:"添加链接",upload:"上传图片",clip2upload:"裁剪上传"},linkModalTips:{linkTitle:"添加链接",imageTitle:"添加图片",descLabel:"链接描述：",descLabelPlaceHolder:"请输入描述...",urlLabel:"链接地址：",urlLabelPlaceHolder:"请输入链接...",buttonOK:"确定"},clipModalTips:{title:"裁剪图片上传",buttonUpload:"上传"},copyCode:{text:"复制代码",successTips:"已复制！",failTips:"复制失败！"},mermaid:{flow:"流程图",sequence:"时序图",gantt:"甘特图",class:"类图",state:"状态图",pie:"饼图",relationship:"关系图",journey:"旅程图"},katex:{inline:"行内公式",block:"块级公式"},footer:{markdownTotal:"字数",scrollAuto:"同步滚动"}},"en-US":{toolbarTips:{bold:"bold",underline:"underline",italic:"italic",strikeThrough:"strikeThrough",title:"title",sub:"subscript",sup:"superscript",quote:"quote",unorderedList:"unordered list",orderedList:"ordered list",task:"task list",codeRow:"inline code",code:"block-level code",link:"link",image:"image",table:"table",mermaid:"mermaid",katex:"formula",revoke:"revoke",next:"undo revoke",save:"save",prettier:"prettier",pageFullscreen:"fullscreen in page",fullscreen:"fullscreen",preview:"preview",htmlPreview:"html preview",catalog:"catalog",github:"source code"},titleItem:{h1:"Lv1 Heading",h2:"Lv2 Heading",h3:"Lv3 Heading",h4:"Lv4 Heading",h5:"Lv5 Heading",h6:"Lv6 Heading"},imgTitleItem:{link:"Add Img Link",upload:"Upload Img",clip2upload:"Clip Upload"},linkModalTips:{linkTitle:"Add Link",imageTitle:"Add Image",descLabel:"Desc:",descLabelPlaceHolder:"Enter a description...",urlLabel:"Link:",urlLabelPlaceHolder:"Enter a link...",buttonOK:"OK"},clipModalTips:{title:"Crop Image",buttonUpload:"Upload"},copyCode:{text:"Copy",successTips:"Copied!",failTips:"Copy failed!"},mermaid:{flow:"flow",sequence:"sequence",gantt:"gantt",class:"class",state:"state",pie:"pie",relationship:"relationship",journey:"journey"},katex:{inline:"inline",block:"block"},footer:{markdownTotal:"Character Count",scrollAuto:"Scroll Auto"}}},Po=`${L}/mermaid/10.6.1/mermaid.esm.min.mjs`,Ct={js:`${L}/KaTeX/0.16.9/katex.min.js`,css:`${L}/KaTeX/0.16.9/katex.min.css`},wt={a11y:{light:`${L}/highlight.js/11.8.0/styles/a11y-light.min.css`,dark:`${L}/highlight.js/11.8.0/styles/a11y-dark.min.css`},atom:{light:`${L}/highlight.js/11.8.0/styles/atom-one-light.min.css`,dark:`${L}/highlight.js/11.8.0/styles/atom-one-dark.min.css`},github:{light:`${L}/highlight.js/11.8.0/styles/github.min.css`,dark:`${L}/highlight.js/11.8.0/styles/github-dark.min.css`},gradient:{light:`${L}/highlight.js/11.8.0/styles/gradient-light.min.css`,dark:`${L}/highlight.js/11.8.0/styles/gradient-dark.min.css`},kimbie:{light:`${L}/highlight.js/11.8.0/styles/kimbie-light.min.css`,dark:`${L}/highlight.js/11.8.0/styles/kimbie-dark.min.css`},paraiso:{light:`${L}/highlight.js/11.8.0/styles/paraiso-light.min.css`,dark:`${L}/highlight.js/11.8.0/styles/paraiso-dark.min.css`},qtcreator:{light:`${L}/highlight.js/11.8.0/styles/qtcreator-light.min.css`,dark:`${L}/highlight.js/11.8.0/styles/qtcreator-dark.min.css`},stackoverflow:{light:`${L}/highlight.js/11.8.0/styles/stackoverflow-light.min.css`,dark:`${L}/highlight.js/11.8.0/styles/stackoverflow-dark.min.css`}},M={editorExtensions:{},editorConfig:{},codeMirrorExtensions:(e,t)=>t,markdownItConfig:()=>{},markdownItPlugins:e=>e,iconfontType:"svg",mermaidConfig:e=>e},ie=170,D=({instance:e,ctx:t,props:o={}},l="default")=>{const i=(e==null?void 0:e.$slots[l])||(t==null?void 0:t.slots[l]);return(i?i(e):"")||o[l]},Ro={overlay:{type:[String,Object],default:""},visible:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}},relative:{type:String,default:"html"}},te=Vue.defineComponent({props:Ro,setup(e,t){const o=`${s}-dropdown-hidden`,l=Vue.reactive({overlayClass:[o],overlayStyle:{},triggerHover:!1,overlayHover:!1}),i=Vue.ref(),r=Vue.ref(),c=()=>{var n;l.triggerHover=!0;const d=i.value,V=r.value;if(!d||!V)return;const k=d.getBoundingClientRect(),g=d.offsetTop,b=d.offsetLeft,f=k.height,h=k.width,v=((n=document.querySelector(e.relative))==null?void 0:n.scrollLeft)||0;l.overlayStyle={...l.overlayStyle,top:g+f+"px",left:b-V.offsetWidth/2+h/2-v+"px"},e.onChange(!0)},m=()=>{l.overlayHover=!0};Vue.watch(()=>e.visible,n=>{n?l.overlayClass=l.overlayClass.filter(d=>d!==o):l.overlayClass.push(o)});let u=-1;const a=n=>{i.value===n.target?l.triggerHover=!1:l.overlayHover=!1,clearTimeout(u),u=window.setTimeout(()=>{!l.overlayHover&&!l.triggerHover&&e.onChange(!1)},10)};return Vue.onMounted(()=>{i.value.addEventListener("mouseenter",c),i.value.addEventListener("mouseleave",a),r.value.addEventListener("mouseenter",m),r.value.addEventListener("mouseleave",a)}),Vue.onBeforeUnmount(()=>{i.value.removeEventListener("mouseenter",c),i.value.removeEventListener("mouseleave",a),r.value.removeEventListener("mouseenter",m),r.value.removeEventListener("mouseleave",a)}),()=>{const n=D({ctx:t}),d=D({props:e,ctx:t},"overlay"),V=Vue.cloneVNode(n instanceof Array?n[0]:n,{ref:i}),k=Vue.createVNode("div",{class:[`${s}-dropdown`,l.overlayClass],style:l.overlayStyle,ref:r},[Vue.createVNode("div",{class:`${s}-dropdown-overlay`},[d instanceof Array?d[0]:d])]);return[V,k]}}}),Bo={title:{type:String,default:""},visible:{type:Boolean},trigger:{type:[String,Object]},onChange:{type:Function},overlay:{type:[String,Object]},insert:{type:Function},language:{type:String},theme:{type:String},default:{type:[String,Object]}},se=Vue.defineComponent({name:"DropdownToolbar",props:Bo,emits:["onChange"],setup(e,t){const o=Vue.inject("editorId");return()=>{const l=D({props:e,ctx:t},"trigger"),i=D({props:e,ctx:t},"overlay"),r=D({props:e,ctx:t});return Vue.createVNode(te,{relative:`#${o}-toolbar-wrapper`,visible:e.visible,onChange:c=>{e.onChange instanceof Function?e.onChange(c):t.emit("onChange",c)},overlay:i},{default:()=>[Vue.createVNode("div",{class:`${s}-toolbar-item`,title:e.title||""},[l,r])]})}}});se.install=e=>(e.component(se.name,se),e);var Do=Object.defineProperty,Oo=(e,t,o)=>t in e?Do(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Uo=(e,t,o)=>(Oo(e,typeof t!="symbol"?t+"":t,o),o);class Wo{constructor(){Uo(this,"pools",{})}remove(t,o,l){const r=this.pools[t]&&this.pools[t][o];r&&(this.pools[t][o]=r.filter(c=>c!==l))}clear(t){this.pools[t]={}}on(t,o){return this.pools[t]||(this.pools[t]={}),this.pools[t][o.name]||(this.pools[t][o.name]=[]),this.pools[t][o.name].push(o.callback),this.pools[t][o.name].includes(o.callback)}emit(t,o,...l){this.pools[t]||(this.pools[t]={});const r=this.pools[t][o];r&&r.forEach(c=>{try{c(...l)}catch(m){console.error(`${o} monitor event exception！`,m)}})}}const y=new Wo,ge="onSave",Te="changeCatalogVisible",Xt="changeFullscreen",$t="pageFullscreenChanged",Tt="fullscreenChanged",Nt="previewChanged",_t="htmlPreviewChanged",xt="catalogVisibleChanged",ce="buildFinished",X="errorCatcher",I="replace",he="uploadImage",we="openModals",Jt="ctrlZ",Yt="ctrlShiftZ",$e="catalogChanged",Qt="pushCatalog",Ne="rerender",eo="eventListener",zo=(e,t="image.png")=>{const o=e.split(","),l=o[0].match(/:(.*?);/);if(l){const i=l[1],r=atob(o[1]);let c=r.length;const m=new Uint8Array(c);for(;c--;)m[c]=r.charCodeAt(c);return new File([m],t,{type:i})}return null},qo=e=>{if(!e)return e;const t=e.split(`
`),o=['<span rn-wrapper aria-hidden="true">'];return t.forEach(()=>{o.push("<span></span>")}),o.push("</span>"),`<span class="code-block">${e}</span>${o.join("")}`},Go=(e,t)=>{if(!e||!t)return 0;const o=e==null?void 0:e.getBoundingClientRect();if(t===document.documentElement)return o.top-t.clientTop;const l=t==null?void 0:t.getBoundingClientRect();return o.top-l.top},Ko=(()=>{let e=0;return t=>t+ ++e})(),St=(e,t)=>{const o=l=>{const i=e.parentElement||document.body,r=i.offsetWidth,c=i.offsetHeight,{clientWidth:m}=document.documentElement,{clientHeight:u}=document.documentElement,a=l.offsetX,n=l.offsetY,d=k=>{let g=k.x+document.body.scrollLeft-document.body.clientLeft-a,b=k.y+document.body.scrollTop-document.body.clientTop-n;g=g<1?1:g<m-r-1?g:m-r-1,b=b<1?1:b<u-c-1?b:u-c-1,t?t(g,b):(i.style.left=`${g}px`,i.style.top=`${b}px`)};document.addEventListener("mousemove",d);const V=()=>{document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",V)};document.addEventListener("mouseup",V)};return e.addEventListener("mousedown",o),()=>{e.removeEventListener("mousedown",o)}},B=(e,t="")=>{const o=document.getElementById(e.id),l=e.onload;e.onload=null;const i=function(r){typeof l=="function"&&l.bind(this)(r),e.removeEventListener("load",i)};o?t!==""&&(o.addEventListener("load",i),Reflect.get(window,t)&&o.dispatchEvent(new Event("load"))):(e.addEventListener("load",i),document.head.appendChild(e))},Zo=fe((e,t,o)=>{const l=document.getElementById(e);l&&l.setAttribute(t,o)},10),Xo=Vue.defineComponent({props:{name:{type:String,default:""}},setup(e){return()=>M.iconfontType==="svg"?Vue.createVNode("svg",{class:`${s}-icon`,"aria-hidden":"true"},[Vue.createVNode("use",{"xlink:href":`#${s}-icon-${e.name}`},null)]):Vue.createVNode("i",{class:`${s}-iconfont ${s}-icon-${e.name}`},null)}}),T=Vue.defineComponent({props:{name:{type:String,default:""}},setup(e){const t=Vue.inject("customIcon");return()=>{const o=t.value[e.name];return typeof o=="object"?typeof o.component=="object"?Vue.h(o.component,o.props):Vue.createVNode("span",{innerHTML:o.component},null):Vue.createVNode(Xo,{name:e.name},null)}}}),Jo={title:{type:String,default:""},visible:{type:Boolean,default:!1},width:{type:String,default:"auto"},height:{type:String,default:"auto"},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function,default:()=>{}},class:{type:String},style:{type:Object,default:()=>({})}},Et=(()=>{let e=2e4;return()=>++e})(),oe=Vue.defineComponent({name:"MdModal",props:Jo,emits:["onClose"],setup(e,t){const o=Vue.inject("theme"),l=Vue.ref(e.visible),i=Vue.ref([`${s}-modal`]),r=Vue.ref(),c=Vue.ref(),m=Vue.ref(),u=Vue.shallowRef();let a=()=>{};const n=Vue.reactive({maskStyle:{zIndex:-1},modalStyle:{zIndex:-1},initPos:{left:"0px",top:"0px"},historyPos:{left:"0px",top:"0px"}}),d=Vue.computed(()=>e.isFullscreen?{width:"100%",height:"100%"}:{width:e.width,height:e.height});return Vue.watch(()=>e.isFullscreen,V=>{V?a():Vue.nextTick(()=>{a=St(c.value,(k,g)=>{n.initPos.left=k+"px",n.initPos.top=g+"px"})})}),Vue.watch(()=>e.visible,V=>{V?(n.maskStyle.zIndex=Et(),n.modalStyle.zIndex=Et(),i.value.push("zoom-in"),l.value=V,Vue.nextTick(()=>{const k=r.value.offsetWidth/2,g=r.value.offsetHeight/2,b=document.documentElement.clientWidth/2,f=document.documentElement.clientHeight/2;n.initPos.left=b-k+"px",n.initPos.top=f-g+"px",e.isFullscreen||(a=St(c.value,(h,v)=>{n.initPos.left=h+"px",n.initPos.top=v+"px"}))}),setTimeout(()=>{i.value=i.value.filter(k=>k!=="zoom-in")},140)):(i.value.push("zoom-out"),a(),setTimeout(()=>{i.value=i.value.filter(k=>k!=="zoom-out"),l.value=V},130))}),Vue.onMounted(()=>{m.value=document.body}),()=>{const V=D({ctx:t}),k=D({props:e,ctx:t},"title");return m.value?Vue.createVNode(Vue.Teleport,{to:m.value},{default:()=>[Vue.createVNode("div",{ref:u,class:`${s}-modal-container`,"data-theme":o.value},[Vue.createVNode("div",{class:e.class,style:{...e.style,display:l.value?"block":"none"}},[Vue.createVNode("div",{class:`${s}-modal-mask`,style:n.maskStyle,onClick:()=>{e.onClose?e.onClose():t.emit("onClose")}},null),Vue.createVNode("div",{class:i.value,style:{...n.modalStyle,...n.initPos,...d.value},ref:r},[Vue.createVNode("div",{class:`${s}-modal-header`,ref:c},[k||""]),Vue.createVNode("div",{class:`${s}-modal-body`},[V]),Vue.createVNode("div",{class:`${s}-modal-func`},[e.showAdjust&&Vue.createVNode("div",{class:`${s}-modal-adjust`,onClick:g=>{g.stopPropagation(),e.isFullscreen?n.initPos=n.historyPos:(n.historyPos=n.initPos,n.initPos={left:"0",top:"0"}),e.onAdjust(!e.isFullscreen)}},[Vue.createVNode(T,{name:e.isFullscreen?"suoxiao":"fangda"},null)]),Vue.createVNode("div",{class:`${s}-modal-close`,onClick:g=>{g.stopPropagation(),e.onClose?e.onClose():t.emit("onClose")}},[Vue.createVNode(T,{name:"close"},null)])])])])])]}):""}}});oe.install=e=>(e.component(oe.name,oe),e);const Yo=(e,t)=>{const o=Vue.inject("editorId"),{noImgZoomIn:l}=e;let i=()=>{};Vue.watch([t,Vue.toRef(e.setting,"preview")],()=>{!l&&e.setting.preview&&i()},{immediate:!0}),Vue.onMounted(()=>{i=fe(()=>{const r=document.querySelectorAll(`#${o}-preview img`);r.length!==0&&_o(r,{background:"#00000073"})})})},Qo=(e,t)=>{if(typeof t[e]=="string")return t[e];const o=`<i class="${s}-iconfont ${s}-icon-${e}"></i>`;switch(M.iconfontType){case"svg":return`<svg class="${s}-icon" aria-hidden="true"><use xlink:href="#${s}-icon-${e}"></use></svg>`;default:return o}},el=(e,t,o)=>{const l=Vue.inject("editorId"),i=Vue.inject("usedLanguageText"),r=Vue.inject("customIcon"),c=()=>{document.querySelectorAll(`#${l}-preview pre`).forEach(a=>{var n,d;let V=-1;(n=a.querySelector(".copy-button"))==null||n.remove();const k=((d=i.value.copyCode)==null?void 0:d.text)||"复制代码",g=document.createElement("span");g.setAttribute("class","copy-button"),g.dataset.tips=k,g.innerHTML=Qo("copy",r.value),g.addEventListener("click",()=>{var b,f;clearTimeout(V);const h=a.querySelector("code").innerText,v=xo(e.formatCopiedText(h)),w=((b=i.value.copyCode)==null?void 0:b.successTips)||"已复制！",$=((f=i.value.copyCode)==null?void 0:f.failTips)||"已复制！";g.dataset.tips=v?w:$,V=window.setTimeout(()=>{g.dataset.tips=k},1500)}),a.appendChild(g)})},m=()=>{Vue.nextTick(c)},u=a=>{a&&Vue.nextTick(c)};Vue.watch([t,o],m),Vue.watch(()=>e.setting.preview,u),Vue.watch(()=>e.setting.htmlPreview,u),Vue.watch(()=>i.value,c),Vue.onMounted(c)},tl=e=>{var t;const o=(t=M.editorExtensions)==null?void 0:t.highlight,l=o==null?void 0:o.instance,i=Vue.inject("highlight"),r=Vue.shallowRef(l);return Vue.onMounted(()=>{if(!e.noHighlight&&!r.value){const c=document.createElement("script");c.src=i.value.js,c.onload=()=>{r.value=window.hljs},c.id=`${s}-hljs`,B(c,"hljs");const m=document.createElement("link");m.rel="stylesheet",m.href=i.value.css,m.id=`${s}-hlCss`,B(m)}}),Vue.watch(()=>i.value.css,c=>{Zo(`${s}-hlCss`,"href",c)}),r},ol=e=>{const t=Vue.inject("theme"),{editorExtensions:o,mermaidConfig:l}=M,i=o==null?void 0:o.mermaid,r=Vue.shallowRef(i==null?void 0:i.instance),c=Vue.shallowRef(-1),m=new Ho({max:1e3,ttl:6e5}),u=()=>{const n=r.value;!e.noMermaid&&n&&(n.initialize(l({startOnLoad:!1,theme:t.value==="dark"?"dark":"default"})),c.value=c.value+1)};return Vue.watch(()=>t.value,()=>{m.clear(),u()}),Vue.onMounted(()=>{if(!e.noMermaid&&!(i!=null&&i.instance)){const n=(i==null?void 0:i.js)||Po;if(/\.mjs/.test(n))fo(()=>import(n),[],import.meta.url).then(d=>{r.value=d.default,u()});else{const d=document.createElement("script");d.id=`${s}-mermaid`,d.src=n,d.onload=()=>{r.value=window.mermaid,u()},B(d,"mermaid")}}}),{mermaidRef:r,reRenderRef:c,replaceMermaid:()=>{Vue.nextTick(()=>{if(!e.noMermaid&&r.value){const n=document.querySelectorAll(`div.${s}-mermaid`),d=document.createElement("div");d.style.width=document.body.offsetWidth+"px",d.style.height=document.body.offsetHeight+"px",d.style.position="fixed",d.style.zIndex="-10000",d.style.top="-10000";let V=n.length;V>0&&document.body.appendChild(d),n.forEach(async k=>{let g=m.get(k.innerText);if(!g){const f=Ce(),h=r.value.renderAsync||r.value.render;let v="";try{v=await h(f,k.innerText,d)}catch(w){}g=await e.sanitizeMermaid(typeof v=="string"?v:v.svg),m.set(k.innerText,g)}const b=document.createElement("p");b.className=`${s}-mermaid`,b.setAttribute("data-processed",""),b.innerHTML=g,k.dataset.line!==void 0&&(b.dataset.line=k.dataset.line),k.replaceWith(b),--V===0&&d.remove()})}})}}},ll=e=>{var t;const o=(t=M.editorExtensions)==null?void 0:t.katex,l=o==null?void 0:o.instance,i=Vue.shallowRef(l);return Vue.onMounted(()=>{if(!e.noKatex&&!i.value){const r=document.createElement("script");r.src=(o==null?void 0:o.js)||Ct.js,r.onload=()=>{i.value=window.katex},r.id=`${s}-katex`;const c=document.createElement("link");c.rel="stylesheet",c.href=(o==null?void 0:o.css)||Ct.css,c.id=`${s}-katexCss`,B(r,"katex"),B(c)}}),i},nl=(e,t)=>{const o=e.renderer.rules.fence.bind(e.renderer.rules);e.renderer.rules.fence=(l,i,r,c,m)=>{const u=l[i],a=u.content.trim();if(u.info==="mermaid"){let n;return l[i].map&&l[i].level===0&&(n=l[i].map[0],l[i].attrSet("data-line",String(n))),`<div class="${s}-mermaid" ${n!==void 0?"data-line="+n:""} data-mermaid-theme=${t.themeRef.value}>${a}</div>`}return o(l,i,r,c,m)}},al=nl,It=(e,t)=>{let o=!0,l=!0;const i=e.posMax,r=t>0?e.src.charCodeAt(t-1):-1,c=t+1<=i?e.src.charCodeAt(t+1):-1;return(r===32||r===9||c>=48&&c<=57)&&(l=!1),(c===32||c===9)&&(o=!1),{can_open:o,can_close:l}},il=(e,t)=>{let o,l,i,r;if(e.src[e.pos]!=="$")return!1;if(i=It(e,e.pos),!i.can_open)return t||(e.pending+="$"),e.pos+=1,!0;const c=e.pos+1;for(o=c;(o=e.src.indexOf("$",o))!==-1;){for(r=o-1;e.src[r]==="\\";)r-=1;if((o-r)%2==1)break;o+=1}return o===-1?(t||(e.pending+="$"),e.pos=c,!0):o-c===0?(t||(e.pending+="$$"),e.pos=c+1,!0):(i=It(e,o),i.can_close?(t||(l=e.push("math_inline","math",0),l.markup="$",l.content=e.src.slice(c,o)),e.pos=o+1,!0):(t||(e.pending+="$"),e.pos=c,!0))},rl=(e,t,o,l)=>{let i,r,c,m,u=!1,a=e.bMarks[t]+e.tShift[t],n=e.eMarks[t];if(a+2>n||e.src.slice(a,a+2)!=="$$")return!1;if(a+=2,i=e.src.slice(a,n),l)return!0;for(i.trim().slice(-2)==="$$"&&(i=i.trim().slice(0,-2),u=!0),c=t;!u&&(c++,!(c>=o||(a=e.bMarks[c]+e.tShift[c],n=e.eMarks[c],a<n&&e.tShift[c]<e.blkIndent)));)e.src.slice(a,n).trim().slice(-2)==="$$"&&(m=e.src.slice(0,n).lastIndexOf("$$"),r=e.src.slice(a,m),u=!0);e.line=c+1;const d=e.push("math_block","math",0);return d.block=!0,d.content=(i&&i.trim()?i+`
`:"")+e.getLines(t+1,c,e.tShift[t],!0)+(r&&r.trim()?r:""),d.map=[t,e.line],d.markup="$$",!0},sl=(e,t)=>{const o=i=>{if(t.katexRef.value){const r=t.katexRef.value.renderToString(i,{throwOnError:!1});return`<span class="${s}-katex-inline" data-processed>${r}</span>`}else return`<span class="${s}-katex-inline">${i}</span>`},l=(i,r)=>{if(t.katexRef.value){const c=t.katexRef.value.renderToString(i,{throwOnError:!1,displayMode:!0});return`<p class="${s}-katex-block" data-line=${r} data-processed>${c}</p>`}else return`<p class="${s}-katex-block" data-line=${r}>${i}</p>`};e.inline.ruler.after("escape","math_inline",il),e.block.ruler.after("blockquote","math_block",rl,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=(i,r)=>o(i[r].content),e.renderer.rules.math_block=(i,r)=>l(i[r].content,i[r].map[0])+`
`},cl=sl,ul=(e,t)=>{t=t||{};const o=3,l=t.marker||"!",i=l.charCodeAt(0),r=l.length;let c="",m="";const u=(n,d,V,k,g)=>{const b=n[d];return b.type==="admonition_open"?(n[d].attrPush(["class",`${s}-admonition ${s}-admonition-${b.info}`]),n[d].attrSet("data-line",String(n[d].map[0]))):b.type==="admonition_title_open"&&n[d].attrPush(["class",`${s}-admonition-title`]),g.renderToken(n,d,V)},a=n=>{const d=n.trim().split(" ",2);m="",c=d[0],d.length>1&&(m=n.substring(c.length+2)),(m===""||!m)&&(m=c)};e.block.ruler.before("code","admonition",(n,d,V,k)=>{let g,b,f,h=!1,v=n.bMarks[d]+n.tShift[d],w=n.eMarks[d];if(i!==n.src.charCodeAt(v))return!1;for(g=v+1;g<=w&&l[(g-v)%r]===n.src[g];g++);const $=Math.floor((g-v)/r);if($!==o)return!1;g-=(g-v)%r;const C=n.src.slice(v,g),_=n.src.slice(g,w);if(a(_),k)return!0;for(b=d;b++,!(b>=V||(v=n.bMarks[b]+n.tShift[b],w=n.eMarks[b],v<w&&n.sCount[b]<n.blkIndent));)if(i===n.src.charCodeAt(v)&&!(n.sCount[b]-n.blkIndent>=4)){for(g=v+1;g<=w&&l[(g-v)%r]===n.src[g];g++);if(!(Math.floor((g-v)/r)<$)&&(g-=(g-v)%r,g=n.skipSpaces(g),!(g<w))){h=!0;break}}const S=n.parentType,x=n.lineMax;return n.parentType="root",n.lineMax=b,f=n.push("admonition_open","div",1),f.markup=C,f.block=!0,f.info=c,f.map=[d,b],f=n.push("admonition_title_open","p",1),f.markup=C+" "+c,f.map=[d,b],f=n.push("inline","",0),f.content=m,f.map=[d,n.line-1],f.children=[],f=n.push("admonition_title_close","p",-1),f.markup=C+" "+c,n.md.block.tokenize(n,d+1,b),f=n.push("admonition_close","div",-1),f.markup=n.src.slice(v,g),f.block=!0,n.parentType=S,n.lineMax=x,n.line=b+(h?1:0),!0},{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.admonition_open=u,e.renderer.rules.admonition_title_open=u,e.renderer.rules.admonition_title_close=u,e.renderer.rules.admonition_close=u},dl=ul,ml=(e,t)=>{e.renderer.rules.heading_open=(o,l)=>{var i;const r=o[l],c=((i=o[l+1].children)==null?void 0:i.reduce((u,a)=>u+(a.content||""),""))||"",m=r.markup.length;return t.headsRef.value.push({text:c,level:m}),r.map&&r.level===0&&(r.attrSet("data-line",String(r.map[0])),r.attrSet("id",t.mdHeadingId(c,m,t.headsRef.value.length))),e.renderer.renderToken(o,l,t)},e.renderer.rules.heading_close=(o,l,i,r,c)=>c.renderToken(o,l,i)},fl=ml,gl=(e,t)=>{const o=e.renderer.rules.fence,l=e.utils.unescapeAll,i=/\[(\w*)(?::([\w ]*))?\]/;function r(a){return a.info?l(a.info).trim():""}function c(a){const n=r(a),[d=null,V=""]=(i.exec(n)||[]).slice(1);return[d,V]}function m(a){const n=r(a);return n?n.split(/(\s+)/g)[0]:""}const u=(a,n,d,V,k)=>{if(a[n].hidden)return"";const[g,b]=c(a[n]);if(g===null)return o(a,n,d,V,k);let f,h,v,w,$="",C="";for(let _=n;_<a.length&&(f=a[_],[h,v]=c(f),h===g);_++)f.info=f.info.replace(i,""),f.hidden=!0,w=_-n>0?"":" checked",$+=`<li><input type="radio" name="label-group-${t.editorId}-${n}"${w}><label for="group-${t.editorId}-${n}-tab-${_-n}" onclick="this.previousElementSibling.click()">${v||m(f)}</label></li>
`,C+=`<input type="radio" id="group-${t.editorId}-${n}-tab-${_-n}" name="group-${t.editorId}-${n}"${w}>
`+o(a,_,d,V,k);return`<div class="code-tabs">
<ul>
`+$+`</ul>
`+C+"</div>"};e.renderer.rules.fence=u},hl=gl,vl=e=>{["paragraph_open","table_open","ordered_list_open","bullet_list_open","blockquote_open","hr","html_block","fence"].forEach(t=>{const o=e.renderer.rules[t];o?e.renderer.rules[t]=(l,i,r,c,m)=>{let u;const a=o(l,i,r,c,m);return l[i].map&&l[i].level===0&&!/^<!--/.test(a)?(u=l[i].map[0],a.replace(/^(<[^>]*)/,`$1 data-line="${u}"`)):a}:e.renderer.rules[t]=(l,i,r,c,m)=>{let u;return l[i].map&&l[i].level===0&&(u=l[i].map[0],l[i].attrSet("data-line",String(u))),m.renderToken(l,i,r)}})},pl=(e,t)=>{const{editorConfig:o,markdownItConfig:l,markdownItPlugins:i}=M,r=Vue.inject("editorId"),c=Vue.inject("showCodeRowNumber"),m=Vue.inject("theme"),u=Vue.ref([]),a=tl(e),n=ll(e),{reRenderRef:d,replaceMermaid:V}=ol(e),k=So({html:!0,breaks:!0});l(k,{editorId:r});const g=[{type:"katex",plugin:cl,options:{katexRef:n}},{type:"image",plugin:Eo,options:{figcaption:!0,classes:"md-zoom"}},{type:"admonition",plugin:dl,options:{}},{type:"taskList",plugin:Io,options:{}},{type:"heading",plugin:fl,options:{mdHeadingId:e.mdHeadingId,headsRef:u}},{type:"codeTabs",plugin:hl,options:{editorId:r}},{type:"xss",plugin:Lo,options:{xss(C){return{whiteList:Object.assign({},C.getDefaultWhiteList(),{input:["class","disabled","type","checked"],iframe:["class","width","height","src","title","border","frameborder","framespacing","allow","allowfullscreen"]})}}}}];e.noMermaid||g.push({type:"mermaid",plugin:al,options:{themeRef:m}}),i(g,{editorId:r}).forEach(C=>{k.use(C.plugin,C.options)});const b=k.options.highlight;k.set({highlight:(C,_,S)=>{if(b){const E=b(C,_,S);if(E)return E}let x;!e.noHighlight&&a.value?a.value.getLanguage(_)?x=a.value.highlight(C,{language:_,ignoreIllegals:!0}).value:x=a.value.highlightAuto(C).value:x=k.utils.escapeHtml(C);const H=c?qo(x.replace(/^\n+|\n+$/g,"")):`<span class="code-block">${x.replace(/^\n+|\n+$/g,"")}</span>`;return`<pre><code class="language-${_}" language=${_}>${H}</code></pre>`}}),vl(k);const f=Vue.ref(`_article-key_${Ce()}`),h=Vue.ref(e.sanitize(k.render(e.modelValue))),v=()=>{y.emit(r,ce,h.value),e.onHtmlChanged(h.value),e.onGetCatalog(u.value),y.emit(r,$e,u.value),V()};Vue.onMounted(v);const w=()=>{u.value=[],h.value=e.sanitize(k.render(e.modelValue)),v()},$=Vue.computed(()=>(e.noKatex||n.value)&&(e.noHighlight||a.value));return Vue.watch([Vue.toRef(e,"modelValue"),$,d],fe(w,(o==null?void 0:o.renderDelay)!==void 0?o==null?void 0:o.renderDelay:t?0:500)),Vue.onMounted(()=>{y.on(r,{name:Qt,callback(){y.emit(r,$e,u.value)}}),y.on(r,{name:Ne,callback:()=>{w(),f.value=`_article-key_${Ce()}`}})}),{html:h,key:f}},bl=pl,to={modelValue:{type:String,default:""},setting:{type:Object,default:()=>({preview:!0})},onHtmlChanged:{type:Function,default:()=>{}},onGetCatalog:{type:Function,default:()=>{}},mdHeadingId:{type:Function,default:()=>""},noMermaid:{type:Boolean,default:!1},sanitize:{type:Function,default:e=>e},noKatex:{type:Boolean,default:!1},formatCopiedText:{type:Function,default:e=>e},noHighlight:{type:Boolean,default:!1},previewOnly:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean},sanitizeMermaid:{type:Function}},Vl={...to,updateModelValue:{type:Function,default:()=>{}},onChange:{type:Function,default:()=>{}},placeholder:{type:String,default:""},scrollAuto:{type:Boolean},autofocus:{type:Boolean},disabled:{type:Boolean},readonly:{type:Boolean},maxlength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function,default:()=>{}},onFocus:{type:Function,default:()=>{}},noPrettier:{type:Boolean},completions:{type:Array},catalogVisible:{type:Boolean},theme:{type:String,default:"light"},onInput:{type:Function},onDrop:{type:Function,default:()=>{}},inputBoxWitdh:{type:String},onInputBoxWitdhChange:{type:Function}},oo=Vue.defineComponent({name:"ContentPreview",props:to,setup(e){const t=Vue.inject("editorId"),o=Vue.inject("previewTheme"),l=Vue.inject("showCodeRowNumber"),{html:i,key:r}=bl(e,e.previewOnly);return el(e,i,r),Yo(e,i),()=>Vue.createVNode(Vue.Fragment,null,[e.setting.preview&&Vue.createVNode("div",{id:`${t}-preview-wrapper`,class:`${s}-preview-wrapper`,key:"content-preview-wrapper"},[Vue.createVNode("div",{key:r.value,id:`${t}-preview`,class:[`${s}-preview`,`${o==null?void 0:o.value}-theme`,l&&`${s}-scrn`],innerHTML:i.value},null)]),!e.previewOnly&&e.setting.htmlPreview&&Vue.createVNode("div",{id:`${t}-html-wrapper`,class:`${s}-preview-wrapper`,key:"html-preview-wrapper"},[Vue.createVNode("div",{class:`${s}-html`},[i.value])])])}}),yl=(e,t)=>{const{editorId:o}=e,l=Vue.reactive({buildFinished:!1,html:""});Vue.watch(()=>e.modelValue,()=>{l.buildFinished=!1}),Vue.onMounted(()=>{y.on(o,{name:ce,callback(i){l.buildFinished=!0,l.html=i}}),y.on(o,{name:ge,callback(){const i=new Promise(r=>{if(l.buildFinished)r(l.html);else{const c=m=>{r(m),y.remove(o,ce,c)};y.on(o,{name:ce,callback:c})}});e.onSave?e.onSave(e.modelValue,i):t.emit("onSave",e.modelValue,i)}})})},lo=e=>{var t,o;const{editorId:l}=e,i=(o=(t=M)==null?void 0:t.editorExtensions)==null?void 0:o.highlight;Vue.provide("editorId",l),Vue.provide("theme",Vue.computed(()=>e.theme)),Vue.provide("language",Vue.computed(()=>e.language)),Vue.provide("highlight",Vue.computed(()=>{const c={...wt,...i==null?void 0:i.css},m=e.codeStyleReverse&&e.codeStyleReverseList.includes(e.previewTheme)?"dark":e.theme;return{js:(i==null?void 0:i.js)||Fo,css:c[e.codeTheme]?c[e.codeTheme][m]:wt.atom[m]}})),Vue.provide("showCodeRowNumber",e.showCodeRowNumber);const r=Vue.computed(()=>{var c,m;const u={...kt,...(m=(c=M)==null?void 0:c.editorConfig)==null?void 0:m.languageUserDefined};return u[e.language]?u[e.language]:kt["zh-CN"]});Vue.provide("usedLanguageText",r),Vue.provide("previewTheme",Vue.computed(()=>e.previewTheme)),Vue.provide("customIcon",Vue.computed(()=>e.customIcon))},kl=e=>{lo(e),Vue.provide("tabWidth",e.tabWidth)},no=e=>{Vue.onMounted(()=>{var t,o;if(!e.noIconfont)if(M.iconfontType==="svg"){const l=document.createElement("script");l.src=((t=M.editorExtensions)==null?void 0:t.iconfont)||Mo,l.id=`${s}-icon`,B(l)}else{const l=document.createElement("link");l.rel="stylesheet",l.href=((o=M.editorExtensions)==null?void 0:o.iconfontClass)||Ao,l.id=`${s}-icon-class`,B(l)}})},Cl=e=>{var t,o,l,i,r,c;const{noPrettier:m,noUploadImg:u}=e,{editorExtensions:a}=M,n=m||!!((o=(t=M.editorExtensions)==null?void 0:t.prettier)!=null&&o.prettierInstance),d=m||!!((i=(l=M.editorExtensions)==null?void 0:l.prettier)!=null&&i.parserMarkdownInstance),V=u||!!((c=(r=M.editorExtensions)==null?void 0:r.cropper)!=null&&c.instance);Vue.onMounted(()=>{var k,g,b,f;const h=document.createElement("script"),v=document.createElement("script");h.src=((k=a==null?void 0:a.prettier)==null?void 0:k.standaloneJs)||Vt.main,h.id=`${s}-prettier`,v.src=((g=a==null?void 0:a.prettier)==null?void 0:g.parserMarkdownJs)||Vt.markdown,v.id=`${s}-prettierMD`;const w=document.createElement("link");w.rel="stylesheet",w.href=((b=a==null?void 0:a.cropper)==null?void 0:b.css)||yt.css,w.id=`${s}-cropperCss`;const $=document.createElement("script");$.src=((f=a==null?void 0:a.cropper)==null?void 0:f.js)||yt.js,$.id=`${s}-cropper`,V||(B(w),B($)),n||B(h),d||B(v)}),no(e)},wl=(e,t)=>{const{editorId:o}=e;Vue.onMounted(()=>{y.on(o,{name:X,callback:l=>{e.onError instanceof Function?e.onError(l):t.emit("onError",l)}})})},$l=(e,t)=>{const{editorId:o}=e,l=Vue.reactive({pageFullscreen:e.pageFullscreen,fullscreen:!1,preview:e.preview,htmlPreview:e.preview?!1:e.htmlPreview}),i=(m,u)=>{l[m]=u===void 0?!l[m]:u,m==="preview"&&l.preview?l.htmlPreview=!1:m==="htmlPreview"&&l.htmlPreview&&(l.preview=!1)};let r="";const c=()=>{l.pageFullscreen||l.fullscreen?document.body.style.overflow="hidden":document.body.style.overflow=r};return Vue.watch(()=>[l.pageFullscreen,l.fullscreen],c),Vue.onMounted(()=>{y.on(o,{name:he,callback(m,u){const a=n=>{y.emit(o,I,"image",{desc:"",urls:n}),u&&u()};e.onUploadImg?e.onUploadImg(m,a):t.emit("onUploadImg",m,a)}}),r=document.body.style.overflow,c()}),[l,i]},Tl=e=>{const{editorId:t}=e,o=Vue.ref(!1);return Vue.onMounted(()=>{y.on(t,{name:Te,callback:i=>{i===void 0?o.value=!o.value:o.value=i}})}),Vue.computed(()=>!e.toolbarsExclude.includes("catalog")&&e.toolbars.includes("catalog")&&o.value)},Nl=(e,t,o,l,i,r)=>{const{editorId:c}=e;Vue.watch(()=>l.pageFullscreen,u=>{y.emit(c,$t,u)}),Vue.watch(()=>l.fullscreen,u=>{y.emit(c,Tt,u)}),Vue.watch(()=>l.preview,u=>{y.emit(c,Nt,u)}),Vue.watch(()=>l.htmlPreview,u=>{y.emit(c,_t,u)}),Vue.watch(o,u=>{y.emit(c,xt,u)});const m={on(u,a){switch(u){case"pageFullscreen":{y.on(c,{name:$t,callback(n){a(n)}});break}case"fullscreen":{y.on(c,{name:Tt,callback(n){a(n)}});break}case"preview":{y.on(c,{name:Nt,callback(n){a(n)}});break}case"htmlPreview":{y.on(c,{name:_t,callback(n){a(n)}});break}case"catalog":{y.on(c,{name:xt,callback(n){a(n)}});break}}},togglePageFullscreen(u){i("pageFullscreen",u)},toggleFullscreen(u){y.emit(c,Xt,u)},togglePreview(u){i("preview",u)},toggleHtmlPreview(u){i("htmlPreview",u)},toggleCatalog(u){y.emit(c,Te,u)},triggerSave(){y.emit(c,ge)},insert(u){y.emit(c,I,"universal",{generate:u})},focus(u){var a;(a=r.value)==null||a.focus(u)},rerender(){y.emit(c,Ne)},getSelectedText(){var u;return(u=r.value)==null?void 0:u.getSelectedText()},resetHistory(){var u;(u=r.value)==null||u.resetHistory()},domEventHandlers(u){y.emit(c,eo,u)}};t.expose(m)},_l=e=>e,ao={modelValue:{type:String,default:""},theme:{type:String,default:"light"},class:{type:String,default:""},language:{type:String,default:"zh-CN"},onHtmlChanged:{type:Function},onGetCatalog:{type:Function},editorId:{type:String,default:()=>Ko("md-editor-v3_")},showCodeRowNumber:{type:Boolean,default:!1},previewTheme:{type:String,default:"default"},style:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:_l},sanitize:{type:Function,default:e=>e},noMermaid:{type:Boolean,default:!1},noKatex:{type:Boolean,default:!1},codeTheme:{type:String,default:"atom"},noIconfont:{type:Boolean},formatCopiedText:{type:Function,default:e=>e},codeStyleReverse:{type:Boolean,default:!0},codeStyleReverseList:{type:Array,default:["default","mk-cute"]},noHighlight:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean,default:!1},customIcon:{type:Object,default:{}},sanitizeMermaid:{type:Function,default:e=>Promise.resolve(e)}},xl={...ao,onChange:{type:Function},onSave:{type:Function},onUploadImg:{type:Function},pageFullscreen:{type:Boolean,default:!1},preview:{type:Boolean,default:!0},htmlPreview:{type:Boolean,default:!1},toolbars:{type:Array,default:Kt},toolbarsExclude:{type:Array,default:[]},noPrettier:{type:Boolean,default:!1},tabWidth:{type:Number,default:2},tableShape:{type:Array,default:()=>[6,4]},placeholder:{type:String,default:""},defToolbars:{type:[String,Object]},onError:{type:Function},footers:{type:Array,default:Zt},scrollAuto:{type:Boolean,default:!0},defFooters:{type:[String,Object]},noUploadImg:{type:Boolean},autoFocus:{type:Boolean},disabled:{type:Boolean},readOnly:{type:Boolean},maxLength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function},onFocus:{type:Function},completions:{type:Array},showToolbarName:{type:Boolean,default:!1},onInput:{type:Function},onDrop:{type:Function},inputBoxWitdh:{type:String,default:"50%"},onInputBoxWitdhChange:{type:Function}},io=["onHtmlChanged","onGetCatalog"],Sl=[...io,"onChange","onSave","onUploadImg","onError","update:modelValue","onBlur","onFocus","onInput","onDrop","onInputBoxWitdhChange"],El=(e,t)=>{const{editorId:o}=e,l={rerender(){y.emit(o,Ne)}};t.expose(l)},ue=Vue.defineComponent({name:"MdPreview",props:ao,emits:io,setup(e,t){const{editorId:o,noKatex:l,noMermaid:i,noHighlight:r}=e;return lo(e),no(e),El(e,t),Vue.onBeforeUnmount(()=>{y.clear(o)}),()=>Vue.createVNode("div",{id:o,class:[s,e.class,e.theme==="dark"&&`${s}-dark`,`${s}-previewOnly`],style:e.style},[Vue.createVNode(oo,{modelValue:e.modelValue,onHtmlChanged:c=>{e.onHtmlChanged?e.onHtmlChanged(c):t.emit("onHtmlChanged",c)},onGetCatalog:c=>{e.onGetCatalog?e.onGetCatalog(c):t.emit("onGetCatalog",c)},mdHeadingId:e.mdHeadingId,noMermaid:i,sanitize:e.sanitize,noKatex:l,formatCopiedText:e.formatCopiedText,noHighlight:r,noImgZoomIn:e.noImgZoomIn,previewOnly:!0,sanitizeMermaid:e.sanitizeMermaid},null)])}});ue.install=e=>(e.component(ue.name,ue),e);const Il={tocItem:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:()=>{}},scrollElement:{type:[String,Object],default:""},onClick:{type:Function,default:()=>{}},scrollElementOffsetTop:{type:Number,default:0}},ro=Vue.defineComponent({props:Il,setup(e){return()=>{const{tocItem:t,mdHeadingId:o,scrollElement:l,onClick:i,scrollElementOffsetTop:r}=e;return Vue.createVNode("div",{class:[`${s}-catalog-link`,t.active&&`${s}-catalog-active`],onClick:c=>{i(c,t),c.stopPropagation();const m=o(t.text,t.level,t.index),u=document.getElementById(m),a=l instanceof Element?l:document.querySelector(l);if(u&&a){let n=u.offsetParent,d=u.offsetTop;if(a.contains(n))for(;n&&a!=n;)d+=n==null?void 0:n.offsetTop,n=n==null?void 0:n.offsetParent;a==null||a.scrollTo({top:d-r,behavior:"smooth"})}}},[Vue.createVNode("span",{title:t.text},[t.text]),Vue.createVNode("div",{class:`${s}-catalog-wrapper`},[t.children&&t.children.map(c=>Vue.createVNode(ro,{mdHeadingId:o,key:`${t.text}-link-${c.level}-${c.text}`,tocItem:c,scrollElement:l,onClick:i,scrollElementOffsetTop:r},null))])])}}}),Ll=ro,Hl={editorId:{type:String},class:{type:String,default:""},mdHeadingId:{type:Function,default:e=>e},scrollElement:{type:[String,Object]},theme:{type:String,default:"light"},offsetTop:{type:Number,default:20},scrollElementOffsetTop:{type:Number,default:0},onClick:{type:Function},onActive:{type:Function}},ae=Vue.defineComponent({name:"MdCatalog",props:Hl,emits:["onClick","onActive"],setup(e,t){const o=e.editorId,l=Vue.reactive({list:[],show:!1,scrollElement:e.scrollElement||`#${o}-preview-wrapper`}),i=Vue.shallowRef(),r=Vue.computed(()=>{const a=[];return l.list.forEach((n,d)=>{const{text:V,level:k}=n,g={level:k,text:V,index:d+1,active:i.value===n};if(a.length===0)a.push(g);else{let b=a[a.length-1];if(g.level>b.level)for(let f=b.level+1;f<=6;f++){const{children:h}=b;if(!h){b.children=[g];break}if(b=h[h.length-1],g.level<=b.level){h.push(g);break}}else a.push(g)}}),a}),c=()=>l.scrollElement instanceof HTMLElement?l.scrollElement:document.querySelector(l.scrollElement),m=a=>{if(a.length===0)return l.list=[],!1;const{activeHead:n}=a.reduce((d,V,k)=>{const g=document.getElementById(e.mdHeadingId(V.text,V.level,k+1));if(g instanceof HTMLElement){const b=c(),f=Go(g,b);if(f<e.offsetTop&&f>d.minTop)return{activeHead:V,minTop:f}}return d},{activeHead:a[0],minTop:Number.MIN_SAFE_INTEGER});i.value=n,l.list=a},u=()=>{m(l.list)};return Vue.watch(()=>i.value,a=>{const n=a?{...a}:void 0;e.onActive?e.onActive(n):t.emit("onActive",n)}),Vue.onMounted(()=>{const a=c(),n=a===document.documentElement?window:a;n==null||n.addEventListener("scroll",u),y.on(o,{name:$e,callback:d=>{n==null||n.removeEventListener("scroll",u),m(d),n==null||n.addEventListener("scroll",u)}}),y.emit(o,Qt)}),Vue.onBeforeUnmount(()=>{var a;const n=c();(a=n===document.documentElement?window:n)==null||a.removeEventListener("scroll",u)}),()=>Vue.createVNode("div",{class:`${s}-catalog${e.theme==="dark"?"-dark":""} ${e.class}`},[r.value.map(a=>Vue.createVNode(Ll,{mdHeadingId:e.mdHeadingId,tocItem:a,key:`link-${a.level}-${a.text}`,scrollElement:l.scrollElement,onClick:(n,d)=>{e.onClick?e.onClick(n,d):t.emit("onClick",n,d)},scrollElementOffsetTop:e.scrollElementOffsetTop},null))])}});ae.install=e=>(e.component(ae.name,ae),e);const Ml={title:{type:String,default:""},trigger:{type:[String,Object]},onClick:{type:Function},insert:{type:Function},language:{type:String},theme:{type:String}},de=Vue.defineComponent({name:"NormalToolbar",props:Ml,emits:["onClick"],setup(e,t){return()=>{const o=D({props:e,ctx:t},"trigger");return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:e.title,onClick:l=>{e.onClick instanceof Function?e.onClick(l):t.emit("onClick",l)}},[o])}}});de.install=e=>(e.component(de.name,de),e);function Al(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Vue.isVNode(e)}const Fl={title:{type:String,default:""},modalTitle:{type:String,default:""},visible:{type:Boolean},width:{type:String,default:"auto"},height:{type:String,default:"auto"},trigger:{type:[String,Object]},onClick:{type:Function},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function},insert:{type:Function},language:{type:String},theme:{type:String}},me=Vue.defineComponent({name:"ModalToolbar",props:Fl,emits:["onClick","onClose","onAdjust"],setup(e,t){return()=>{const o=D({props:e,ctx:t},"trigger"),l=D({props:e,ctx:t},"default");return Vue.createVNode(Vue.Fragment,null,[Vue.createVNode("div",{class:`${s}-toolbar-item`,title:e.title,onClick:()=>{e.onClick instanceof Function?e.onClick():t.emit("onClick")}},[o]),Vue.createVNode(oe,{width:e.width,height:e.height,title:e.modalTitle,visible:e.visible,onClose:()=>{e.onClose instanceof Function?e.onClose():t.emit("onClose")},showAdjust:e.showAdjust,isFullscreen:e.isFullscreen,onAdjust:i=>{e.onAdjust instanceof Function?e.onAdjust(i):t.emit("onAdjust",i)}},Al(l)?l:{default:()=>[l]})])}}});me.install=e=>(e.component(me.name,me),e);var jl=Object.defineProperty,Pl=(e,t,o)=>t in e?jl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,K=(e,t,o)=>(Pl(e,typeof t!="symbol"?t+"":t,o),o);const Rl=Vue.defineComponent({setup(){return()=>Vue.createVNode("div",{class:`${s}-divider`},null)}}),Bl={noPrettier:{type:Boolean},toolbars:{type:Array,default:()=>[]},toolbarsExclude:{type:Array,default:()=>[]},setting:{type:Object,default:()=>({})},screenfull:{type:Object,default:null},screenfullJs:{type:String,default:""},updateSetting:{type:Function,default:()=>{}},tableShape:{type:Array,default:()=>[6,4]},defToolbars:{type:Object},noUploadImg:{type:Boolean},showToolbarName:{type:Boolean}},Dl=e=>{var t,o,l,i;const r=Vue.inject("editorId");let c=(o=(t=M.editorExtensions)==null?void 0:t.screenfull)==null?void 0:o.instance;const m=(i=(l=M.editorExtensions)==null?void 0:l.screenfull)==null?void 0:i.js,u=Vue.ref(!1),a=V=>{if(!c){y.emit(r,X,{name:"fullscreen",message:"fullscreen is undefined"});return}c.isEnabled?(u.value=!0,(V===void 0?!c.isFullscreen:V)?c.request():c.exit()):console.error("browser does not support screenfull!")},n=()=>{c&&c.isEnabled&&c.on("change",()=>{(u.value||e.setting.fullscreen)&&(u.value=!1,e.updateSetting("fullscreen"))})},d=()=>{c=window.screenfull,n()};return Vue.onMounted(()=>{if(n(),!c){const V=document.createElement("script");V.src=m||jo,V.onload=d,V.id=`${s}-screenfull`,B(V,"screenfull")}}),Vue.onMounted(()=>{y.on(r,{name:Xt,callback:a})}),{fullscreenHandler:a}},Ol={tableShape:{type:Array,default:()=>[6,4]},onSelected:{type:Function,default:()=>{}}},Ul=Vue.defineComponent({name:"TableShape",props:Ol,setup(e){const t=Vue.reactive({x:-1,y:-1});return()=>Vue.createVNode("div",{class:`${s}-table-shape`,onMouseleave:()=>{t.x=-1,t.y=-1}},[new Array(e.tableShape[1]).fill("").map((o,l)=>Vue.createVNode("div",{class:`${s}-table-shape-row`,key:`table-shape-row-${l}`},[new Array(e.tableShape[0]).fill("").map((i,r)=>Vue.createVNode("div",{class:`${s}-table-shape-col`,key:`table-shape-col-${r}`,onMouseenter:()=>{t.x=l,t.y=r},onClick:()=>{e.onSelected(t)}},[Vue.createVNode("div",{class:[`${s}-table-shape-col-default`,l<=t.x&&r<=t.y&&`${s}-table-shape-col-include`]},null)]))]))])}}),Wl=Ul,zl={type:{type:String,default:"link"},visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},ql=Vue.defineComponent({props:zl,setup(e){const t=Vue.inject("usedLanguageText"),o=Vue.inject("editorId"),l=Vue.computed(()=>{var r,c;switch(e.type){case"link":return(r=t.value.linkModalTips)==null?void 0:r.linkTitle;case"image":return(c=t.value.linkModalTips)==null?void 0:c.imageTitle;default:return""}}),i=Vue.reactive({desc:"",url:""});return Vue.watch(()=>e.visible,r=>{r||setTimeout(()=>{i.desc="",i.url=""},200)}),()=>Vue.createVNode(oe,{title:l.value,visible:e.visible,onClose:e.onCancel},{default:()=>{var r,c,m,u,a;return[Vue.createVNode("div",{class:`${s}-form-item`},[Vue.createVNode("label",{class:`${s}-label`,for:`link-desc-${o}`},[(r=t.value.linkModalTips)==null?void 0:r.descLabel]),Vue.createVNode("input",{placeholder:(c=t.value.linkModalTips)==null?void 0:c.descLabelPlaceHolder,class:`${s}-input`,id:`link-desc-${o}`,type:"text",value:i.desc,onChange:n=>{i.desc=n.target.value},autocomplete:"off"},null)]),Vue.createVNode("div",{class:`${s}-form-item`},[Vue.createVNode("label",{class:`${s}-label`,for:`link-url-${o}`},[(m=t.value.linkModalTips)==null?void 0:m.urlLabel]),Vue.createVNode("input",{placeholder:(u=t.value.linkModalTips)==null?void 0:u.urlLabelPlaceHolder,class:`${s}-input`,id:`link-url-${o}`,type:"text",value:i.url,onChange:n=>{i.url=n.target.value},autocomplete:"off"},null)]),Vue.createVNode("div",{class:`${s}-form-item`},[Vue.createVNode("button",{class:[`${s}-btn`,`${s}-btn-row`],type:"button",onClick:()=>{e.onOk(i),i.desc="",i.url=""}},[(a=t.value.linkModalTips)==null?void 0:a.buttonOK])])]}})}}),Gl={visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},Kl=Vue.defineComponent({props:Gl,setup(e){var t,o,l;const i=Vue.inject("usedLanguageText"),r=Vue.inject("editorId");let c=(l=(o=(t=M)==null?void 0:t.editorExtensions)==null?void 0:o.cropper)==null?void 0:l.instance;const m=Vue.ref(),u=Vue.ref(),a=Vue.ref(),n=Vue.reactive({cropperInited:!1,imgSelected:!1,imgSrc:"",isFullscreen:!1});let d=null;Vue.watch(()=>e.visible,()=>{e.visible&&!n.cropperInited&&(c=c||window.Cropper,m.value.onchange=()=>{if(!c){y.emit(r,X,{name:"Cropper",message:"Cropper is undefined"});return}const k=m.value.files||[];if(n.imgSelected=!0,(k==null?void 0:k.length)>0){const g=new FileReader;g.onload=b=>{n.imgSrc=b.target.result,Vue.nextTick(()=>{d=new c(u.value,{viewMode:2,preview:`.${s}-clip-preview-target`})})},g.readAsDataURL(k[0])}})}),Vue.watch(()=>[n.imgSelected],()=>{a.value.style=""}),Vue.watch(()=>n.isFullscreen,()=>{Vue.nextTick(()=>{d==null||d.destroy(),a.value.style="",u.value&&(d=new c(u.value,{viewMode:2,preview:`.${s}-clip-preview-target`}))})});const V=()=>{d.clear(),d.destroy(),d=null,m.value.value="",n.imgSelected=!1};return()=>{var k;return Vue.createVNode(oe,{class:`${s}-modal-clip`,title:(k=i.value.clipModalTips)==null?void 0:k.title,visible:e.visible,onClose:e.onCancel,showAdjust:!0,isFullscreen:n.isFullscreen,onAdjust:g=>{n.isFullscreen=g},width:"668px",height:"421px"},{default:()=>{var g,b;return[Vue.createVNode("div",{class:`${s}-form-item ${s}-clip`},[Vue.createVNode("div",{class:`${s}-clip-main`},[n.imgSelected?Vue.createVNode("div",{class:`${s}-clip-cropper`},[Vue.createVNode("img",{src:n.imgSrc,ref:u,style:{display:"none"},alt:""},null),Vue.createVNode("div",{class:`${s}-clip-delete`,onClick:V},[Vue.createVNode(T,{name:"delete"},null)])]):Vue.createVNode("div",{class:`${s}-clip-upload`,onClick:()=>{m.value.click()}},[Vue.createVNode(T,{name:"upload"},null)])]),Vue.createVNode("div",{class:`${s}-clip-preview`},[Vue.createVNode("div",{class:`${s}-clip-preview-target`,ref:a},null)])]),Vue.createVNode("div",{class:`${s}-form-item`},[Vue.createVNode("button",{class:`${s}-btn`,type:"button",onClick:()=>{if(d){const f=d.getCroppedCanvas();y.emit(r,he,[zo(f.toDataURL("image/png"))],e.onOk),V()}}},[((g=i.value.clipModalTips)==null?void 0:g.buttonUpload)||((b=i.value.linkModalTips)==null?void 0:b.buttonOK)])]),Vue.createVNode("input",{ref:m,accept:"image/*",type:"file",multiple:!1,style:{display:"none"}},null)]}})}}}),Zl={type:{type:String,default:"link"},linkVisible:{type:Boolean,default:!1},clipVisible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},Xl=Vue.defineComponent({props:Zl,setup(e){return()=>Vue.createVNode(Vue.Fragment,null,[Vue.createVNode(ql,{type:e.type,visible:e.linkVisible,onOk:e.onOk,onCancel:e.onCancel},null),Vue.createVNode(Kl,{visible:e.clipVisible,onOk:e.onOk,onCancel:e.onCancel},null)])}}),Jl=Vue.defineComponent({name:"MDEditorToolbar",props:Bl,setup(e){const t=Vue.inject("editorId"),o=Vue.inject("usedLanguageText"),l=Vue.inject("theme"),i=Vue.inject("language"),{fullscreenHandler:r}=Dl(e),c=`${t}-toolbar-wrapper`,m=Vue.ref(),u=Vue.reactive({title:!1,catalog:!1,image:!1,table:!1,mermaid:!1,katex:!1}),a=(f,h)=>{y.emit(t,I,f,h)},n=Vue.reactive({type:"link",linkVisible:!1,clipVisible:!1}),d=Vue.ref();Vue.onMounted(()=>{y.on(t,{name:we,callback(f){n.type=f,n.linkVisible=!0}})});const V=Vue.computed(()=>{const f=e.toolbars.filter($=>!e.toolbarsExclude.includes($)),h=f.indexOf("="),v=h===-1?f:f.slice(0,h+1),w=h===-1?[]:f.slice(h,Number.MAX_SAFE_INTEGER);return[v,w]}),k=Vue.ref(),g=()=>{y.emit(t,he,Array.from(k.value.files||[])),k.value.value=""};Vue.onMounted(()=>{k.value.addEventListener("change",g)});const b=f=>{var h,v,w,$,C,_,S,x,H,E,O,R,P,U,J,Y,W,q,G,j,A,ve,_e,xe,Se,Ee,Ie,Le,He,Me,Ae,Fe,je,Pe,Re,Be,De,Oe,Ue,We,ze,qe,Ge,Ke,Ze,Xe,Je,Ye,Qe,et,tt,ot,lt,nt,at,it,rt,st,ct,ut,dt,mt,ft,gt,ht,vt,pt;if(Kt.includes(f))switch(f){case"-":return Vue.createVNode(Rl,null,null);case"bold":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(h=o.value.toolbarTips)==null?void 0:h.bold,onClick:()=>{a("bold")}},[Vue.createVNode(T,{name:"bold"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(v=o.value.toolbarTips)==null?void 0:v.bold])]);case"underline":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(w=o.value.toolbarTips)==null?void 0:w.underline,onClick:()=>{a("underline")}},[Vue.createVNode(T,{name:"underline"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[($=o.value.toolbarTips)==null?void 0:$.underline])]);case"italic":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(C=o.value.toolbarTips)==null?void 0:C.italic,onClick:()=>{a("italic")}},[Vue.createVNode(T,{name:"italic"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(_=o.value.toolbarTips)==null?void 0:_.italic])]);case"strikeThrough":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(S=o.value.toolbarTips)==null?void 0:S.strikeThrough,onClick:()=>{a("strikeThrough")}},[Vue.createVNode(T,{name:"strike-through"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(x=o.value.toolbarTips)==null?void 0:x.strikeThrough])]);case"title":return Vue.createVNode(te,{relative:`#${c}`,visible:u.title,onChange:N=>{u.title=N},overlay:Vue.createVNode("ul",{class:`${s}-menu`,onClick:()=>{u.title=!1}},[Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-title`,onClick:()=>{a("h1")}},[(H=o.value.titleItem)==null?void 0:H.h1]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-title`,onClick:()=>{a("h2")}},[(E=o.value.titleItem)==null?void 0:E.h2]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-title`,onClick:()=>{a("h3")}},[(O=o.value.titleItem)==null?void 0:O.h3]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-title`,onClick:()=>{a("h4")}},[(R=o.value.titleItem)==null?void 0:R.h4]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-title`,onClick:()=>{a("h5")}},[(P=o.value.titleItem)==null?void 0:P.h5]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-title`,onClick:()=>{a("h6")}},[(U=o.value.titleItem)==null?void 0:U.h6])])},{default:()=>{var N,F;return[Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(N=o.value.toolbarTips)==null?void 0:N.title},[Vue.createVNode(T,{name:"title"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(F=o.value.toolbarTips)==null?void 0:F.title])])]}});case"sub":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(J=o.value.toolbarTips)==null?void 0:J.sub,onClick:()=>{a("sub")}},[Vue.createVNode(T,{name:"sub"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(Y=o.value.toolbarTips)==null?void 0:Y.sub])]);case"sup":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(W=o.value.toolbarTips)==null?void 0:W.sup,onClick:()=>{a("sup")}},[Vue.createVNode(T,{name:"sup"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(q=o.value.toolbarTips)==null?void 0:q.sup])]);case"quote":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(G=o.value.toolbarTips)==null?void 0:G.quote,onClick:()=>{a("quote")}},[Vue.createVNode(T,{name:"quote"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(j=o.value.toolbarTips)==null?void 0:j.quote])]);case"unorderedList":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(A=o.value.toolbarTips)==null?void 0:A.unorderedList,onClick:()=>{a("unorderedList")}},[Vue.createVNode(T,{name:"unordered-list"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(ve=o.value.toolbarTips)==null?void 0:ve.unorderedList])]);case"orderedList":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(_e=o.value.toolbarTips)==null?void 0:_e.orderedList,onClick:()=>{a("orderedList")}},[Vue.createVNode(T,{name:"ordered-list"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(xe=o.value.toolbarTips)==null?void 0:xe.orderedList])]);case"task":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(Se=o.value.toolbarTips)==null?void 0:Se.task,onClick:()=>{a("task")}},[Vue.createVNode(T,{name:"task"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(Ee=o.value.toolbarTips)==null?void 0:Ee.task])]);case"codeRow":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(Ie=o.value.toolbarTips)==null?void 0:Ie.codeRow,onClick:()=>{a("codeRow")}},[Vue.createVNode(T,{name:"code-row"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(Le=o.value.toolbarTips)==null?void 0:Le.codeRow])]);case"code":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(He=o.value.toolbarTips)==null?void 0:He.code,onClick:()=>{a("code")}},[Vue.createVNode(T,{name:"code"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(Me=o.value.toolbarTips)==null?void 0:Me.code])]);case"link":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(Ae=o.value.toolbarTips)==null?void 0:Ae.link,onClick:()=>{n.type="link",n.linkVisible=!0}},[Vue.createVNode(T,{name:"link"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(Fe=o.value.toolbarTips)==null?void 0:Fe.link])]);case"image":return e.noUploadImg?Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(je=o.value.toolbarTips)==null?void 0:je.image,onClick:()=>{n.type="image",n.linkVisible=!0}},[Vue.createVNode(T,{name:"image"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(Pe=o.value.toolbarTips)==null?void 0:Pe.image])]):Vue.createVNode(te,{relative:`#${c}`,visible:u.image,onChange:N=>{u.image=N},overlay:Vue.createVNode("ul",{class:`${s}-menu`,onClick:()=>{u.title=!1}},[Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-image`,onClick:()=>{n.type="image",n.linkVisible=!0}},[(Re=o.value.imgTitleItem)==null?void 0:Re.link]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-image`,onClick:()=>{k.value.click()}},[(Be=o.value.imgTitleItem)==null?void 0:Be.upload]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-image`,onClick:()=>{n.clipVisible=!0}},[(De=o.value.imgTitleItem)==null?void 0:De.clip2upload])])},{default:()=>{var N,F;return[Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(N=o.value.toolbarTips)==null?void 0:N.image},[Vue.createVNode(T,{name:"image"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(F=o.value.toolbarTips)==null?void 0:F.image])])]}});case"table":return Vue.createVNode(te,{relative:`#${c}`,visible:u.table,onChange:N=>{u.table=N},key:"bar-table",overlay:Vue.createVNode(Wl,{tableShape:e.tableShape,onSelected:N=>{a("table",{selectedShape:N})}},null)},{default:()=>{var N,F;return[Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(N=o.value.toolbarTips)==null?void 0:N.table},[Vue.createVNode(T,{name:"table"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(F=o.value.toolbarTips)==null?void 0:F.table])])]}});case"revoke":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(Oe=o.value.toolbarTips)==null?void 0:Oe.revoke,onClick:()=>{y.emit(t,Jt)}},[Vue.createVNode(T,{name:"revoke"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(Ue=o.value.toolbarTips)==null?void 0:Ue.revoke])]);case"next":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(We=o.value.toolbarTips)==null?void 0:We.next,onClick:()=>{y.emit(t,Yt)}},[Vue.createVNode(T,{name:"next"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(ze=o.value.toolbarTips)==null?void 0:ze.next])]);case"save":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(qe=o.value.toolbarTips)==null?void 0:qe.save,onClick:()=>{y.emit(t,ge)}},[Vue.createVNode(T,{name:"baocun"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(Ge=o.value.toolbarTips)==null?void 0:Ge.save])]);case"prettier":return e.noPrettier?"":Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(Ke=o.value.toolbarTips)==null?void 0:Ke.prettier,onClick:()=>{a("prettier")}},[Vue.createVNode(T,{name:"prettier"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(Ze=o.value.toolbarTips)==null?void 0:Ze.prettier])]);case"pageFullscreen":return!e.setting.fullscreen&&Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(Xe=o.value.toolbarTips)==null?void 0:Xe.pageFullscreen,onClick:()=>{e.updateSetting("pageFullscreen")}},[Vue.createVNode(T,{name:e.setting.pageFullscreen?"suoxiao":"fangda"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(Je=o.value.toolbarTips)==null?void 0:Je.pageFullscreen])]);case"fullscreen":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(Ye=o.value.toolbarTips)==null?void 0:Ye.fullscreen,onClick:()=>{r()}},[Vue.createVNode(T,{name:e.setting.fullscreen?"fullscreen-exit":"fullscreen"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(Qe=o.value.toolbarTips)==null?void 0:Qe.fullscreen])]);case"preview":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(et=o.value.toolbarTips)==null?void 0:et.preview,onClick:()=>{e.updateSetting("preview")}},[Vue.createVNode(T,{name:"preview"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(tt=o.value.toolbarTips)==null?void 0:tt.preview])]);case"htmlPreview":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(ot=o.value.toolbarTips)==null?void 0:ot.htmlPreview,onClick:()=>{e.updateSetting("htmlPreview")}},[Vue.createVNode(T,{name:"coding"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(lt=o.value.toolbarTips)==null?void 0:lt.htmlPreview])]);case"catalog":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(nt=o.value.toolbarTips)==null?void 0:nt.catalog,onClick:()=>{y.emit(t,Te)},key:"bar-catalog"},[Vue.createVNode(T,{name:"catalog"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(at=o.value.toolbarTips)==null?void 0:at.catalog])]);case"github":return Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(it=o.value.toolbarTips)==null?void 0:it.github,onClick:()=>co("https://github.com/imzbf/md-editor-v3")},[Vue.createVNode(T,{name:"github"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(rt=o.value.toolbarTips)==null?void 0:rt.github])]);case"mermaid":return Vue.createVNode(te,{relative:`#${c}`,visible:u.mermaid,onChange:N=>{u.mermaid=N},overlay:Vue.createVNode("ul",{class:`${s}-menu`,onClick:()=>{u.mermaid=!1}},[Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{a("flow")}},[(st=o.value.mermaid)==null?void 0:st.flow]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{a("sequence")}},[(ct=o.value.mermaid)==null?void 0:ct.sequence]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{a("gantt")}},[(ut=o.value.mermaid)==null?void 0:ut.gantt]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{a("class")}},[(dt=o.value.mermaid)==null?void 0:dt.class]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{a("state")}},[(mt=o.value.mermaid)==null?void 0:mt.state]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{a("pie")}},[(ft=o.value.mermaid)==null?void 0:ft.pie]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{a("relationship")}},[(gt=o.value.mermaid)==null?void 0:gt.relationship]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{a("journey")}},[(ht=o.value.mermaid)==null?void 0:ht.journey])]),key:"bar-mermaid"},{default:()=>{var N,F;return[Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(N=o.value.toolbarTips)==null?void 0:N.mermaid},[Vue.createVNode(T,{name:"mermaid"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(F=o.value.toolbarTips)==null?void 0:F.mermaid])])]}});case"katex":return Vue.createVNode(te,{relative:`#${c}`,visible:u.katex,onChange:N=>{u.katex=N},overlay:Vue.createVNode("ul",{class:`${s}-menu`,onClick:()=>{u.katex=!1}},[Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-katex`,onClick:()=>{a("katexInline")}},[(vt=o.value.katex)==null?void 0:vt.inline]),Vue.createVNode("li",{class:`${s}-menu-item ${s}-menu-item-katex`,onClick:()=>{a("katexBlock")}},[(pt=o.value.katex)==null?void 0:pt.block])]),key:"bar-katex"},{default:()=>{var N,F;return[Vue.createVNode("div",{class:`${s}-toolbar-item`,title:(N=o.value.toolbarTips)==null?void 0:N.katex},[Vue.createVNode(T,{name:"formula"},null),e.showToolbarName&&Vue.createVNode("div",{class:`${s}-toolbar-item-name`},[(F=o.value.toolbarTips)==null?void 0:F.katex])])]}})}else if(e.defToolbars instanceof Array){const N=e.defToolbars[f];return N?Vue.cloneVNode(N,{theme:l.value,language:i.value,insert(pe){y.emit(t,I,"universal",{generate:pe})}}):""}else if(e.defToolbars&&e.defToolbars.children instanceof Array){const N=e.defToolbars.children[f];return N?Vue.cloneVNode(N,{theme:l.value,language:i.value,insert(pe){y.emit(t,I,"universal",{generate:pe})}}):""}else return""};return Vue.watch(()=>e.toolbars,()=>{Vue.nextTick(()=>{m.value&&so(m.value)})},{immediate:!0}),()=>{const f=V.value[0].map(v=>b(v)),h=V.value[1].map(v=>b(v));return Vue.createVNode(Vue.Fragment,null,[e.toolbars.length>0&&Vue.createVNode("div",{class:`${s}-toolbar-wrapper`,ref:m,id:c},[Vue.createVNode("div",{class:[`${s}-toolbar`,e.showToolbarName&&`${s}-stn`]},[Vue.createVNode("div",{class:`${s}-toolbar-left`,ref:d},[f]),Vue.createVNode("div",{class:`${s}-toolbar-right`},[h])])]),Vue.createVNode("input",{ref:k,accept:"image/*",type:"file",multiple:!0,style:{display:"none"}},null),Vue.createVNode(Xl,{linkVisible:n.linkVisible,clipVisible:n.clipVisible,type:n.type,onCancel:()=>{n.linkVisible=!1,n.clipVisible=!1},onOk:v=>{v&&a(n.type,{desc:v.desc,url:v.url}),n.linkVisible=!1,n.clipVisible=!1}},null)])}}}),Yl=`.${s}-preview > [data-line]`,Ql=(e,t)=>{const o=fe(()=>{e.removeEventListener("scroll",l),e.addEventListener("scroll",l),t.removeEventListener("scroll",l),t.addEventListener("scroll",l)},50),l=i=>{const r=e.clientHeight,c=t.clientHeight,m=e.scrollHeight,u=t.scrollHeight,a=(m-r)/(u-c);i.target===e?(t.removeEventListener("scroll",l),t.scrollTo({top:e.scrollTop/a}),o()):(e.removeEventListener("scroll",l),e.scrollTo({top:t.scrollTop*a}),o())};return[()=>{o().finally(()=>{e.dispatchEvent(new Event("scroll"))})},()=>{e.removeEventListener("scroll",l),t.removeEventListener("scroll",l)}]},en=(e,t,o)=>{const{view:l}=o,i=mo(),r=f=>l.lineBlockAt(l.state.doc.line(f).from).top,c=f=>l.lineBlockAt(l.state.doc.line(f).from).height;let m=[],u=[],a=[];const n=()=>{var $;m=[],u=[],a=[],u=u.concat(Array.from(t.querySelectorAll(Yl)));const f=u.map(C=>Number(C.dataset.line)+1);a=a.concat(f);const{lines:h}=l.state.doc;let v=1,w=($=f.shift())!=null?$:h;for(let C=1;C<=h;C++)C===w&&(v=C,w=f.shift()||h+1),m.push({start:v,end:w-1})};let d=0,V=0;const k=()=>{var f,h;if(V!==0)return!1;d++;const{scrollDOM:v,contentHeight:w}=l;let $=+getComputedStyle(t).paddingTop.replace("px","");const C=l.lineBlockAtHeight(v.scrollTop),{number:_}=l.state.doc.lineAt(C.from),S=m[_-1];if(!S)return!1;let x=r(S.end)+c(S.end),H=0;const E=r(S.start),O=t.querySelector(`[data-line="${S.start-1}"]`)||((f=t.firstElementChild)==null?void 0:f.firstElementChild),R=t.querySelector(`[data-line="${S.end}"]`)||((h=t.lastElementChild)==null?void 0:h.lastElementChild);let P=0,U=0;E===0?(H=v.scrollTop/x,O===R?($=0,x=w-v.offsetHeight,P=R.offsetTop+R.offsetHeight-t.clientHeight):P=R.offsetTop):(H=(v.scrollTop-E)/(x-E),U=O.offsetTop,P=R.offsetTop-U),x>v.scrollHeight-v.clientHeight&&(H=(v.scrollTop-E)/(v.scrollHeight-v.clientHeight-E),U=O.offsetTop,P=t.scrollHeight-t.clientHeight-U+10);const J=U-$+P*H;i(t,J,()=>{d--})},g=()=>{var f,h,v,w,$,C;if(d!==0)return;V++;const{scrollDOM:_}=l,S=t.scrollTop,x=t.scrollHeight;let H=(f=t.firstElementChild)==null?void 0:f.firstElementChild,E=(h=t.firstElementChild)==null?void 0:h.lastElementChild;if(a.length>0){let G=Math.ceil(Number(a[a.length-1])*(S/x)),j=a.findLastIndex(A=>A<=G);j=j===-1?0:j,G=a[j];for(let A=j;A>=0&&A<a.length;)if(u[A].offsetTop>S){if(A-1>=0){A--;continue}G=-1,j=A;break}else{if(A+1<=a.length&&u[A+1].offsetTop<S){A++;continue}G=a[A],j=A;break}switch(G){case-1:{H=(v=t.firstElementChild)==null?void 0:v.firstElementChild,E=u[j];break}case a.length-1:{H=u[j],E=(w=t.firstElementChild)==null?void 0:w.lastElementChild;break}default:H=u[j],E=u[j+1]}}const O=H===(($=t.firstElementChild)==null?void 0:$.firstElementChild)?0:H.offsetTop;let R=E.offsetTop,P=0;const{start:U,end:J}=m[Number(H.dataset.line||0)],Y=r(U);let W=r(J+1),q=0;W>_.scrollHeight-_.clientHeight||E.scrollTop>t.scrollHeight-t.clientHeight?(P=Math.max((S-O)/(t.scrollHeight-O-t.clientHeight),0),W=r(l.state.doc.lines)+c(l.state.doc.lines),q=8+W-Y-e.clientHeight):H===((C=t.firstElementChild)==null?void 0:C.firstElementChild)?(H===E&&(R=E.offsetTop+E.offsetHeight+ +getComputedStyle(E).marginBottom.replace("px","")),q=W,P=Math.max(S/R,0)):(P=Math.max((S-O)/(R-O),0),q=W-Y),i(e,Y+q*P,()=>{V--})},b=uo(f=>{var h;const{scrollDOM:v,contentHeight:w}=l,$=v.clientHeight;if(w<=$||t.firstElementChild.clientHeight<=t.clientHeight||l.state.doc.lines<((h=m[m.length-1])==null?void 0:h.end))return!1;f.target===e?k():g()},8);return[()=>{n(),e.addEventListener("scroll",b),t.addEventListener("scroll",b),e.dispatchEvent(new Event("scroll"))},()=>{e.removeEventListener("scroll",b),t.removeEventListener("scroll",b)}]},tn=(e,t,o)=>{const l=Vue.inject("editorId");let i=()=>{},r=()=>{};const c=()=>{i();const m=document.querySelector(`#${l} .cm-scroller`),u=document.querySelector(`[id="${l}-preview-wrapper"]`),a=document.querySelector(`[id="${l}-html-wrapper"]`);(u||a)&&([r,i]=(u?en:Ql)(m,u||a,o.value)),e.scrollAuto&&r()};Vue.watch([t,Vue.toRef(e.setting,"preview"),Vue.toRef(e.setting,"htmlPreview"),Vue.toRef(e.setting,"fullscreen"),Vue.toRef(e.setting,"pageFullscreen")],()=>{Vue.nextTick(c)}),Vue.watch(()=>e.scrollAuto,m=>{m?r():i()}),Vue.onMounted(c)},on=(e,t,o)=>{var f;var l,i,r,c,m,u;let a="",n=0,d=0,V=!0,k=!1;const g=t.getSelectedText(),b=(l=M.editorConfig)==null?void 0:l.mermaidTemplate;if(/^h[1-6]{1}$/.test(e)){const h=e.replace(/^h(\d)/,(v,w)=>new Array(Number(w)).fill("#",0,w).join(""));a=`${h} ${g}`,n=h.length+1}else if(e==="prettier"){const h=window.prettier||((r=(i=M.editorExtensions)==null?void 0:i.prettier)==null?void 0:r.prettierInstance),v=[((c=window.prettierPlugins)==null?void 0:c.markdown)||((u=(m=M.editorExtensions)==null?void 0:m.prettier)==null?void 0:u.parserMarkdownInstance)];!h||v[0]===void 0?(y.emit(o.editorId,X,{name:"prettier",message:"prettier is undefined"}),a=t.getValue()):a=h.format(t.getValue(),{parser:"markdown",plugins:v}),V=!1,k=!0}else switch(e){case"bold":{a=`**${g}**`,n=2,d=-2;break}case"underline":{a=`<u>${g}</u>`,n=3,d=-4;break}case"italic":{a=`*${g}*`,n=1,d=-1;break}case"strikeThrough":{a=`~~${g}~~`,n=2,d=-2;break}case"sub":{a=`<sub>${g}</sub>`,n=5,d=-6;break}case"sup":{a=`<sup>${g}</sup>`,n=5,d=-6;break}case"codeRow":{a="`"+g+"`",n=1,d=-1;break}case"quote":{a=`> ${g}`,n=2;break}case"orderedList":{a=`1. ${g}`,n=3;break}case"unorderedList":{a=`- ${g}`,n=2;break}case"task":{a=`- [ ] ${g}`,n=6;break}case"code":{const h=o.text||g||"",v=o.mode||"language";a=`\`\`\`${v}
${h}
\`\`\`
`,n=3,d=3+v.length-a.length;break}case"table":{a="|";const{selectedShape:h={x:1,y:1}}=o,{x:v,y:w}=h;for(let $=0;$<=w;$++)a+=" col |";a+=`
|`;for(let $=0;$<=w;$++)a+=" - |";for(let $=0;$<=v;$++){a+=`
|`;for(let C=0;C<=w;C++)a+=" content |"}n=2,d=5-a.length;break}case"link":{const{desc:h,url:v}=o;a=`[${h}](${v})`,V=!1;break}case"image":{const{desc:h,url:v,urls:w}=o;w instanceof Array?a=w.reduce(($,C)=>{const{url:_="",alt:S="",title:x=""}=typeof C=="object"?C:{url:C};return $+`![${S}](${_}${x?" '"+x+"'":""})
`},""):a=`![${h}](${v})
`,V=!1;break}case"flow":{a=`\`\`\`mermaid
${(b==null?void 0:b.flow)||`flowchart TD 
  Start --> Stop`}
\`\`\`
`,n=3,d=10-a.length;break}case"sequence":{a=`\`\`\`mermaid
${(b==null?void 0:b.sequence)||`sequenceDiagram
  A->>B: hello!
  B-->>A: hi!
  A-)B: bye!`}
\`\`\`
`,n=3,d=10-a.length;break}case"gantt":{a=`\`\`\`mermaid
${(b==null?void 0:b.gantt)||`gantt
title A Gantt Diagram
dateFormat  YYYY-MM-DD
section Section
A task  :a1, 2014-01-01, 30d
Another task  :after a1, 20d`}
\`\`\`
`,n=3,d=10-a.length;break}case"class":{a=`\`\`\`mermaid
${(b==null?void 0:b.class)||`classDiagram
  class Animal
  Vehicle <|-- Car`}
\`\`\`
`,n=3,d=10-a.length;break}case"state":{a=`\`\`\`mermaid
${(b==null?void 0:b.state)||`stateDiagram-v2
  s1 --> s2`}
\`\`\`
`,n=3,d=10-a.length;break}case"pie":{a=`\`\`\`mermaid
${(b==null?void 0:b.pie)||`pie title Pets adopted by volunteers
  "Dogs" : 386
  "Cats" : 85
  "Rats" : 15`}
\`\`\`
`,n=3,d=10-a.length;break}case"relationship":{a=`\`\`\`mermaid
${(b==null?void 0:b.relationship)||`erDiagram
  CAR ||--o{ NAMED-DRIVER : allows
  PERSON ||--o{ NAMED-DRIVER : is`}
\`\`\`
`,n=3,d=10-a.length;break}case"journey":{a=`\`\`\`mermaid
${(b==null?void 0:b.journey)||`journey
  title My working day
  section Go to work
    Make tea: 5: Me
    Go upstairs: 3: Me
    Do work: 1: Me, Cat
  section Go home
    Go downstairs: 5: Me
    Sit down: 5: Me`}
\`\`\`
`,n=3,d=10-a.length;break}case"katexInline":{a="$$",n=1,d=-1;break}case"katexBlock":{a=`$$

$$
`,n=3,d=-4;break}case"universal":{const{generate:h}=o,v=h(g);a=v.targetValue,V=(f=v.select)!=null?f:!0,n=v.deviationStart||0,d=v.deviationEnd||0}}return{text:a,options:{select:V,deviationStart:n,deviationEnd:d,replaceAll:k}}},ln="#e5c07b",Lt="var(--md-color)",nn="#56b6c2",an="#ffffff",le="var(--md-color)",Ht="#e5c07b",rn="#e5c07b",sn="var(--md-color)",Mt="#d19a66",cn="#c678dd",un="#21252b",dn="#2c313a",At="var(--md-bk-color)",Ve="var(--md-bk-color)",mn="#ceedfa33",Ft="#528bff",fn=Z.theme({"&":{color:le,backgroundColor:At},".cm-content":{caretColor:Ft},".cm-cursor, .cm-dropCursor":{borderLeftColor:Ft},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:mn},".cm-panels":{backgroundColor:un,color:le},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:At,color:le,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:dn},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:Ve},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Ve,borderBottomColor:Ve},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:le}}},{dark:!0}),gn=qt.define([{tag:p.keyword,color:cn},{tag:[p.name,p.deleted,p.character,p.propertyName,p.macroName],color:Lt},{tag:[p.function(p.variableName),p.labelName],color:rn},{tag:[p.color,p.constant(p.name),p.standard(p.name)],color:Mt},{tag:[p.definition(p.name),p.separator],color:le},{tag:[p.typeName,p.className,p.number,p.changed,p.annotation,p.modifier,p.self,p.namespace],color:ln},{tag:[p.operator,p.operatorKeyword,p.url,p.escape,p.regexp,p.link,p.special(p.string)],color:nn},{tag:[p.meta,p.comment],color:Ht},{tag:p.strong,fontWeight:"bold"},{tag:p.emphasis,fontStyle:"italic"},{tag:p.strikethrough,textDecoration:"line-through"},{tag:p.link,color:Ht,textDecoration:"underline"},{tag:p.heading,fontWeight:"bold",color:Lt},{tag:[p.atom,p.bool,p.special(p.variableName)],color:Mt},{tag:[p.processingInstruction,p.string,p.inserted],color:sn},{tag:p.invalid,color:an}]),jt=[fn,Gt(gn)],hn="#e5c07b",Pt="#3f4a54",vn="#56b6c2",pn="#fff",ne="#3f4a54",Rt="#2d8cf0",bn="#2d8cf0",Vn="#3f4a54",Bt="#d19a66",yn="#c678dd",kn="#21252b",Cn="#ceedfa33",Dt="var(--md-bk-color)",ye="var(--md-bk-color)",wn="#bad5fa",Ot="#3f4a54",$n=Z.theme({"&":{color:ne,backgroundColor:Dt},".cm-content":{caretColor:Ot},".cm-cursor, .cm-dropCursor":{borderLeftColor:Ot},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:wn},".cm-panels":{backgroundColor:kn,color:ne},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:Dt,color:ne,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:Cn},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:ye},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:ye,borderBottomColor:ye},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:ne}}}),Tn=qt.define([{tag:p.keyword,color:yn},{tag:[p.name,p.deleted,p.character,p.propertyName,p.macroName],color:Pt},{tag:[p.function(p.variableName),p.labelName],color:bn},{tag:[p.color,p.constant(p.name),p.standard(p.name)],color:Bt},{tag:[p.definition(p.name),p.separator],color:ne},{tag:[p.typeName,p.className,p.number,p.changed,p.annotation,p.modifier,p.self,p.namespace],color:hn},{tag:[p.operator,p.operatorKeyword,p.url,p.escape,p.regexp,p.link,p.special(p.string)],color:vn},{tag:[p.meta,p.comment],color:Rt},{tag:p.strong,fontWeight:"bold"},{tag:p.emphasis,fontStyle:"italic"},{tag:p.strikethrough,textDecoration:"line-through"},{tag:p.link,color:Rt,textDecoration:"underline"},{tag:p.heading,fontWeight:"bold",color:Pt},{tag:[p.atom,p.bool,p.special(p.variableName)],color:Bt},{tag:[p.processingInstruction,p.string,p.inserted],color:Vn},{tag:p.invalid,color:pn}]),Ut=[$n,Gt(Tn)],re=(e,t,o,l,i)=>(r,c,m,u)=>{const a=`${e}${t}`.slice(u-m);r.dispatch(r.state.replaceSelection(`${a}${o}${l}`));const n=m+c.label.length+(i==="title"?o.length:0);r.dispatch({selection:z.create([z.range(m+c.label.length+(i==="title"?1:-t.length),n),z.cursor(n)],1)}),r.focus()},Wt=e=>(t,o,l,i)=>{const r=e.slice(i-l);t.dispatch(t.state.replaceSelection(`${r} `))},zt=e=>{const t=o=>{const l=o.matchBefore(/^#+|^-\s*\[*\s*\]*|`+|\[|!\[*|^\|\s?\|?|^\$\$?|!+\s*\w*/);return l===null||l.from==l.to&&o.explicit?null:{from:l.from,options:[...["h1","h2","h3","h4","h5","h6"].map((i,r)=>{const c=new Array(r+1).fill("#").join("");return{label:c,type:"text",apply:Wt(c)}}),...["unchecked","checked"].map(i=>{const r=i==="checked"?"- [x]":"- [ ]";return{label:r,type:"text",apply:Wt(r)}}),...[["`",""],["```","language"],["```mermaid\n",""]].map(i=>({label:`${i[0]}${i[1]}`,type:"text",apply:re(i[0],i[1],"",i[0]==="`"?"`":"\n```","type")})),{label:"[]()",type:"text"},{label:"![]()",type:"text"},{label:"| |",type:"text",detail:"table",apply:`| col | col | col |
| - | - | - |
| content | content | content |
| content | content | content |`},{label:"$",type:"text",apply:re("$","","","$","type")},{label:"$$",type:"text",apply:re("$$","",`
`,`
$$`,"title")},...["note","abstract","info","tip","success","question","warning","failure","danger","bug","example","quote","hint","caution","error","attention"].map(i=>({label:`!!! ${i}`,type:"text",apply:re("!!!",` ${i}`," Title",`

!!!`,"title")}))]}};return Co({override:e?[t,...e]:[t]})},Q=e=>{const t=new ee;return l=>(t.get(e.state)?e.dispatch({effects:t.reconfigure(l)}):e.dispatch({effects:No.appendConfig.of(t.of(l))}),!0)};class Nn{constructor(t){K(this,"view"),K(this,"maxLength",Number.MAX_SAFE_INTEGER),K(this,"toggleTabSize"),K(this,"togglePlaceholder"),K(this,"setExtensions"),K(this,"toggleDisabled"),K(this,"toggleReadOnly"),K(this,"toggleMaxlength"),this.view=t,this.toggleTabSize=Q(this.view),this.togglePlaceholder=Q(this.view),this.setExtensions=Q(this.view),this.toggleDisabled=Q(this.view),this.toggleReadOnly=Q(this.view),this.toggleMaxlength=Q(this.view)}getValue(){return this.view.state.doc.toString()}setValue(t,o=0,l=this.view.state.doc.length){this.view.dispatch({changes:{from:o,to:l,insert:t}})}getSelectedText(){const{from:t,to:o}=this.view.state.selection.main;return this.view.state.sliceDoc(t,o)}replaceSelectedText(t,o={select:!0,deviationStart:0,deviationEnd:0,replaceAll:!1},l){try{if(o.replaceAll){if(this.setValue(t),t.length>this.maxLength)throw new Error("The input text is too long");return}if(this.view.state.doc.length-this.getSelectedText().length+t.length>this.maxLength)throw new Error("The input text is too long");const{from:i}=this.view.state.selection.main;if(this.view.dispatch(this.view.state.replaceSelection(t)),o.select){const r=i+t.length+o.deviationEnd;this.view.dispatch({selection:z.create([z.range(i+o.deviationStart,r),z.cursor(r)],1)})}this.view.focus()}catch(i){if(i.message==="The input text is too long")y.emit(l,X,{name:"overlength",message:i.message,data:t});else throw i}}setTabSize(t){this.toggleTabSize([be.tabSize.of(t),wo.of(" ".repeat(t))])}setPlaceholder(t){this.togglePlaceholder($o(t))}focus(t){if(this.view.focus(),!t)return;let o=0,l=0,i=0;switch(t){case"start":break;case"end":{o=l=i=this.getValue().length;break}default:o=t.rangeAnchor||t.cursorPos,l=t.rangeHead||t.cursorPos,i=t.cursorPos}this.view.dispatch({scrollIntoView:!0,selection:z.create([z.range(o,l),z.cursor(i)],1)})}setDisabled(t){this.toggleDisabled([Z.editable.of(!t)])}setReadOnly(t){this.toggleReadOnly([be.readOnly.of(t)])}setMaxLength(t){this.maxLength=t,this.toggleMaxlength([be.changeFilter.of(o=>o.newDoc.length<=t)])}}const _n=e=>{const t=Vue.inject("editorId");return l=>{if(!l.clipboardData)return;if(l.clipboardData.files.length>0){const{files:r}=l.clipboardData;y.emit(t,he,Array.from(r).filter(c=>/image\/.*/.test(c.type))),l.preventDefault();return}if(e.autoDetectCode&&l.clipboardData.types.includes("vscode-editor-data")){const r=JSON.parse(l.clipboardData.getData("vscode-editor-data"));y.emit(t,I,"code",{mode:r.mode,text:l.clipboardData.getData("text/plain")}),l.preventDefault();return}const i=l.clipboardData.getData("text/plain");e.maxlength&&i.length+e.modelValue.length>e.maxlength&&y.emit(t,X,{name:"overlength",message:"The input text is too long",data:i})}},xn=(e,t)=>[{key:"Ctrl-b",mac:"Cmd-b",run:()=>(y.emit(e,I,"bold"),!0)},{key:"Ctrl-d",mac:"Cmd-d",run:To,preventDefault:!0},{key:"Ctrl-s",mac:"Cmd-s",run:$=>(y.emit(e,ge,$.state.doc.toString()),!0),shift:()=>(y.emit(e,I,"strikeThrough"),!0)},{key:"Ctrl-u",mac:"Cmd-u",run:()=>(y.emit(e,I,"underline"),!0),shift:()=>(y.emit(e,I,"unorderedList"),!0)},{key:"Ctrl-i",mac:"Cmd-i",run:()=>(y.emit(e,I,"italic"),!0),shift:()=>(y.emit(e,we,"image"),!0)},{key:"Ctrl-1",mac:"Cmd-1",run:()=>(y.emit(e,I,"h1"),!0)},{key:"Ctrl-2",mac:"Cmd-2",run:()=>(y.emit(e,I,"h2"),!0)},{key:"Ctrl-3",mac:"Cmd-3",run:()=>(y.emit(e,I,"h3"),!0)},{key:"Ctrl-4",mac:"Cmd-4",run:()=>(y.emit(e,I,"h4"),!0)},{key:"Ctrl-5",mac:"Cmd-5",run:()=>(y.emit(e,I,"h5"),!0)},{key:"Ctrl-6",mac:"Cmd-6",run:()=>(y.emit(e,I,"h6"),!0)},{key:"Ctrl-ArrowUp",mac:"Cmd-ArrowUp",run:()=>(y.emit(e,I,"sup"),!0)},{key:"Ctrl-ArrowDown",mac:"Cmd-ArrowDown",run:()=>(y.emit(e,I,"sub"),!0)},{key:"Ctrl-o",mac:"Cmd-o",run:()=>(y.emit(e,I,"orderedList"),!0)},{key:"Ctrl-c",mac:"Cmd-c",shift:()=>(y.emit(e,I,"code"),!0),any($,C){return(C.ctrlKey||C.metaKey)&&C.altKey&&C.code==="KeyC"?(y.emit(e,I,"codeRow"),!0):!1}},{key:"Ctrl-l",mac:"Cmd-l",run:()=>(y.emit(e,we,"link"),!0)},{key:"Ctrl-f",mac:"Cmd-f",shift:()=>t.noPrettier?!1:(y.emit(e,I,"prettier"),!0)},{any:($,C)=>(C.ctrlKey||C.metaKey)&&C.altKey&&C.shiftKey&&C.code==="KeyT"?(y.emit(e,I,"table"),!0):!1}],Sn=e=>{const t=Vue.inject("tabWidth"),o=Vue.inject("editorId"),l=Vue.inject("theme"),i=Vue.ref(),r=Vue.shallowRef(),c=new ee,m=new ee,u=new ee,a=new ee,n=new ee,d=xn(o,e),V=Vue.ref(!1),g={paste:_n(e),blur:e.onBlur,focus:e.onFocus,drop:e.onDrop,compositionstart:()=>{console.log("compositionstart"),V.value=!0},compositionend:(h,v)=>{console.log("compositionend"),V.value=!1,e.updateModelValue(v.state.doc.toString())},input:h=>{e.onInput&&e.onInput(h);const{data:v}=h;e.maxlength&&e.modelValue.length+v.length>e.maxlength&&y.emit(o,X,{name:"overlength",message:"The input text is too long",data:v})}},b=[go.of([...ho,...vo,...d,po]),a.of(bt()),c.of(bo({codeLanguages:Vo})),Z.lineWrapping,Z.updateListener.of(h=>{h.docChanged&&(e.onChange(h.state.doc.toString()),V.value||e.updateModelValue(h.state.doc.toString()))}),n.of(Z.domEventHandlers(g))],f=()=>{const h=[...b,m.of(l.value==="light"?Ut:jt),u.of(zt(e.completions))];return M.codeMirrorExtensions(l.value,h,[...d])};return Vue.onMounted(()=>{const h=new Z({doc:e.modelValue,parent:i.value,extensions:[f()]}),v=new Nn(h);r.value=v,setTimeout(()=>{v.setTabSize(t),v.setDisabled(e.disabled),v.setReadOnly(e.readonly),e.placeholder&&v.setPlaceholder(e.placeholder),typeof e.maxlength=="number"&&v.setMaxLength(e.maxlength),e.autofocus&&h.focus()},0),y.on(o,{name:Jt,callback(){yo(h)}}),y.on(o,{name:Yt,callback(){ko(h)}}),y.on(o,{name:I,callback(w,$={}){var C;const{text:_,options:S}=on(w,r.value,$);(C=r.value)==null||C.replaceSelectedText(_,S,o)}}),y.on(o,{name:eo,callback(w){var $;const C={...g},_=Object.keys(g);for(const S in w){const x=S;_.includes(x)?C[x]=(H,E)=>{w[x](H,E),H.defaultPrevented||g[x](H,E)}:C[x]=w[x]}($=r.value)==null||$.view.dispatch({effects:n.reconfigure(Z.domEventHandlers(C))})}})}),Vue.watch(l,()=>{var h;(h=r.value)==null||h.view.dispatch({effects:m.reconfigure(l.value==="light"?Ut:jt)})},{deep:!0}),Vue.watch(()=>e.completions,()=>{var h;(h=r.value)==null||h.view.dispatch({effects:u.reconfigure(zt(e.completions))})},{deep:!0}),Vue.watch(()=>e.modelValue,()=>{var h,v;((h=r.value)==null?void 0:h.getValue())!==e.modelValue&&((v=r.value)==null||v.setValue(e.modelValue))}),Vue.watch(()=>e.placeholder,()=>{var h;(h=r.value)==null||h.setPlaceholder(e.placeholder)}),Vue.watch(()=>e.disabled,()=>{var h;(h=r.value)==null||h.setDisabled(e.disabled)}),Vue.watch(()=>e.readonly,()=>{var h;(h=r.value)==null||h.setDisabled(e.readonly)}),Vue.watch(()=>e.maxlength,()=>{var h;e.maxlength&&((h=r.value)==null||h.setMaxLength(e.maxlength))}),{inputWrapperRef:i,codeMirrorUt:r,resetHistory(){var h,v;(h=r.value)==null||h.view.dispatch({effects:a.reconfigure([])}),(v=r.value)==null||v.view.dispatch({effects:a.reconfigure(bt())})}}},En=(e,t,o)=>{const l=Vue.reactive({resizedWidth:e.inputBoxWitdh}),i=Vue.reactive({width:e.inputBoxWitdh}),r=Vue.reactive({left:e.inputBoxWitdh,display:"initial"}),c=a=>{var n,d,V;const k=((n=t.value)==null?void 0:n.offsetWidth)||0,g=((d=t.value)==null?void 0:d.getBoundingClientRect().x)||0;let b=a.x-g;b<ie?b=ie:b>k-ie&&(b=k-ie);const f=`${b}px`;i.width=f,r.left=f,l.resizedWidth=f,(V=e.onInputBoxWitdhChange)==null||V.call(e,f)},m=()=>{document.addEventListener("mousemove",c)},u=()=>{document.removeEventListener("mousemove",c)};return Vue.onMounted(()=>{var a;(a=o.value)==null||a.addEventListener("mousedown",m),document.addEventListener("mouseup",u)}),Vue.onBeforeUnmount(()=>{var a,n;(a=o.value)==null||a.removeEventListener("mousedown",m),(n=o.value)==null||n.removeEventListener("mouseup",u)}),Vue.watch(()=>e.inputBoxWitdh,a=>{a&&(i.width=a,r.left=a)}),Vue.watch([Vue.toRef(e.setting,"htmlPreview"),Vue.toRef(e.setting,"preview")],()=>{!e.setting.htmlPreview&&!e.setting.preview?(i.width="100%",r.display="none"):(i.width=l.resizedWidth,r.display="initial")},{immediate:!0}),{inputWrapperStyle:i,resizeOperateStyle:r}},In=Vue.defineComponent({name:"MDEditorContent",props:Vl,setup(e,t){const o=Vue.inject("editorId"),l=Vue.ref(""),i=Vue.ref(),r=Vue.ref(),{inputWrapperRef:c,codeMirrorUt:m,resetHistory:u}=Sn(e),{inputWrapperStyle:a,resizeOperateStyle:n}=En(e,i,r);return tn(e,l,m),t.expose({getSelectedText(){var d;return(d=m.value)==null?void 0:d.getSelectedText()},focus(d){var V;(V=m.value)==null||V.focus(d)},resetHistory:u}),()=>Vue.createVNode("div",{class:`${s}-content${e.setting.htmlPreview||e.setting.preview?" has-preview":""}`,ref:i},[Vue.createVNode("div",{class:`${s}-input-wrapper`,style:a,ref:c},null),(e.setting.htmlPreview||e.setting.preview)&&Vue.createVNode("div",{class:`${s}-resize-operate`,style:n,ref:r},null),Vue.createVNode(oo,{modelValue:e.modelValue,setting:e.setting,onHtmlChanged:d=>{l.value=d,e.onHtmlChanged(d)},onGetCatalog:e.onGetCatalog,mdHeadingId:e.mdHeadingId,noMermaid:e.noMermaid,sanitize:e.sanitize,noKatex:e.noKatex,formatCopiedText:e.formatCopiedText,noHighlight:e.noHighlight,noImgZoomIn:e.noImgZoomIn,sanitizeMermaid:e.sanitizeMermaid},null),e.catalogVisible&&Vue.createVNode(ae,{theme:e.theme,class:`${s}-catalog-editor`,editorId:o,mdHeadingId:e.mdHeadingId,key:"internal-catalog"},null)])}}),Ln=Vue.defineComponent({props:{modelValue:{type:String,default:""}},setup(e){const t=Vue.inject("usedLanguageText");return()=>{var o,l;return Vue.createVNode("div",{class:`${s}-footer-item`},[Vue.createVNode("label",{class:`${s}-footer-label`},[`${(o=t.value.footer)==null?void 0:o.markdownTotal}:`]),Vue.createVNode("span",null,[((l=e.modelValue)==null?void 0:l.length)||0])])}}}),Hn={checked:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}}},Mn=Vue.defineComponent({props:Hn,setup(e){return()=>Vue.createVNode("div",{class:[`${s}-checkbox`,e.checked&&`${s}-checkbox-checked`],onClick:()=>{e.onChange(!e.checked)}},null)}}),An={scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}}},Fn=Vue.defineComponent({props:An,setup(e){const t=Vue.inject("usedLanguageText");return()=>{var o;return Vue.createVNode("div",{class:`${s}-footer-item`},[Vue.createVNode("label",{class:`${s}-footer-label`,onClick:()=>{e.onScrollAutoChange(!e.scrollAuto)}},[(o=t.value.footer)==null?void 0:o.scrollAuto]),Vue.createVNode(Mn,{checked:e.scrollAuto,onChange:e.onScrollAutoChange},null)])}}}),jn={modelValue:{type:String,default:""},footers:{type:Array,default:[]},scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}},defFooters:{type:Object}},Pn=Vue.defineComponent({name:"MDEditorFooter",props:jn,setup(e){const t=Vue.computed(()=>{const l=e.footers.indexOf("="),i=l===-1?e.footers:e.footers.slice(0,l),r=l===-1?[]:e.footers.slice(l,Number.MAX_SAFE_INTEGER);return[i,r]}),o=l=>{if(Zt.includes(l))switch(l){case"markdownTotal":return Vue.createVNode(Ln,{modelValue:e.modelValue},null);case"scrollSwitch":return Vue.createVNode(Fn,{scrollAuto:e.scrollAuto,onScrollAutoChange:e.onScrollAutoChange},null)}else return e.defFooters instanceof Array?e.defFooters[l]||"":e.defFooters&&e.defFooters.children instanceof Array&&e.defFooters.children[l]||""};return()=>{const l=t.value[0].map(r=>o(r)),i=t.value[1].map(r=>o(r));return Vue.createVNode("div",{class:`${s}-footer`},[Vue.createVNode("div",{class:`${s}-footer-left`},[l]),Vue.createVNode("div",{class:`${s}-footer-right`},[i])])}}}),ke=Vue.defineComponent({name:"MdEditorV3",props:xl,emits:Sl,setup(e,t){const{editorId:o,noKatex:l,noMermaid:i,noPrettier:r,noUploadImg:c,noHighlight:m}=e,u=Vue.reactive({scrollAuto:e.scrollAuto}),a=Vue.ref();yl(e,t),kl(e),Cl(e),wl(e,t);const[n,d]=$l(e,t),V=Tl(e);return Vue.onBeforeUnmount(()=>{y.clear(o)}),Nl(e,t,V,n,d,a),()=>{var k;const g=D({props:e,ctx:t},"defToolbars"),b=D({props:e,ctx:t},"defFooters");return Vue.createVNode("div",{id:o,class:[s,e.class,e.theme==="dark"&&`${s}-dark`,n.fullscreen||n.pageFullscreen?`${s}-fullscreen`:""],style:e.style},[Vue.createVNode(Jl,{noPrettier:r,toolbars:e.toolbars,toolbarsExclude:e.toolbarsExclude,setting:n,updateSetting:d,tableShape:e.tableShape,defToolbars:g,noUploadImg:c,showToolbarName:e.showToolbarName},null),Vue.createVNode(In,{ref:a,modelValue:e.modelValue,setting:n,mdHeadingId:e.mdHeadingId,noMermaid:i,noPrettier:r,sanitize:e.sanitize,placeholder:e.placeholder,noKatex:l,scrollAuto:u.scrollAuto,formatCopiedText:e.formatCopiedText,autofocus:e.autoFocus,disabled:e.disabled,readonly:e.readOnly,maxlength:e.maxLength,autoDetectCode:e.autoDetectCode,noHighlight:m,updateModelValue:f=>{t.emit("update:modelValue",f)},onChange:f=>{e.onChange&&e.onChange(f),t.emit("onChange",f)},onHtmlChanged:f=>{e.onHtmlChanged&&e.onHtmlChanged(f),t.emit("onHtmlChanged",f)},onGetCatalog:f=>{e.onGetCatalog&&e.onGetCatalog(f),t.emit("onGetCatalog",f)},onBlur:f=>{e.onBlur&&e.onBlur(f),t.emit("onBlur",f)},onFocus:f=>{e.onFocus&&e.onFocus(f),t.emit("onFocus",f)},onInput:f=>{e.onInput&&e.onInput(f),t.emit("onInput",f)},completions:e.completions,catalogVisible:V.value,theme:e.theme,noImgZoomIn:e.noImgZoomIn,onDrop:f=>{e.onDrop&&e.onDrop(f),t.emit("onDrop",f)},inputBoxWitdh:e.inputBoxWitdh,onInputBoxWitdhChange:f=>{e.onInputBoxWitdhChange&&e.onInputBoxWitdhChange(f),t.emit("onInputBoxWitdhChange",f)},sanitizeMermaid:e.sanitizeMermaid},null),((k=e.footers)==null?void 0:k.length)>0&&Vue.createVNode(Pn,{modelValue:e.modelValue,footers:e.footers,defFooters:b,scrollAuto:u.scrollAuto,onScrollAutoChange:f=>u.scrollAuto=f},null)])}}});ke.install=e=>(e.component(ke.name,ke),e.use(de).use(se).use(me).use(ae).use(ue),e);export{ke as E,ue as M};
